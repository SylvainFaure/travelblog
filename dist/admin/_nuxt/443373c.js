(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{287:function(e,t,r){"use strict";r.r(t);r(62);var n=r(286),c={props:{type:n.a.string.def("primary"),label:n.a.string.def("Save"),iconBtn:n.a.bool.def(!1),icon:n.a.string.def("checkmark"),additionalClasses:n.a.string.def("")},computed:{classes:function(){var e=this.iconBtn?"px-4 py-2":"p-2";return"cursor-pointer bg-".concat(this.type||"primary"," ").concat("raw"===this.type?"":"border text-white"," ").concat(e)}}},o=r(24),component=Object(o.a)(c,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("button",{class:[e.classes,e.additionalClasses,"rounded text-center flex items-center"],attrs:{type:"button"},on:{click:function(t){return e.$emit("click")}}},[e.iconBtn?e._e():r("span",[e._v(e._s(e.label))]),e._v(" "),e.icon&&!e.iconBtn?r("span",{staticClass:"pl-2"},[r("Icon",{attrs:{name:e.icon}})],1):r("span",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.label,expression:"label"}]},[r("Icon",{attrs:{name:e.icon}})],1)])}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{Icon:r(288).default})},288:function(e,t,r){"use strict";r.r(t);var n=r(286),c={props:{name:n.a.string.def(""),small:n.a.bool.def(!1)}},o=r(24),component=Object(o.a)(c,(function(){var e=this.$createElement,t=this._self._c||e;return t("svg",this._g({class:{"fill-current icon":!0,"cursor-pointer":!!this.$listeners,"w-2 h-2":this.small,"w-4 h-4":!this.small}},this.$listeners),[t("use",{attrs:{"xlink:href":"#icon-"+this.name}})])}),[],!1,null,null,null);t.default=component.exports},294:function(e,t,r){"use strict";r.r(t);var n={},c=r(24),component=Object(c.a)(n,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("portal",{attrs:{to:"modal"}},[r("div",{staticClass:"flex flex-col justify-center items-center m-16"},[r("h4",{staticClass:"font-bold text-lg text-center mb-4"},[e._v(e._s(e.$t("general.sure")))]),e._v(" "),r("div",{staticClass:"flex justify-center"},[r("Btn",{attrs:{label:e.$t("general.confirm"),"additional-classes":"mr-4"},on:{click:function(t){return e.$emit("confirm")}}}),e._v(" "),r("Btn",{attrs:{label:e.$t("general.cancel"),type:"secondary"},on:{click:function(t){return e.$emit("cancel")}}})],1)])])}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{Btn:r(287).default})},381:function(e,t,r){"use strict";r.r(t);r(19),r(62),r(27),r(17),r(134),r(53),r(36),r(37),r(28),r(16),r(38),r(18),r(40);var n=r(9),c=r(15),o=(r(32),r(4)),l=r(20),d=r(374);function v(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}function f(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?v(Object(source),!0).forEach((function(t){Object(n.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):v(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var m={asyncData:function(e){return Object(o.a)(regeneratorRuntime.mark((function t(){var r,n,o,l,d,v,f,m,h,y,_,x;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.app,n=e.$axios,o=r.i18n.locale,l="fr"===o?"it":"fr",d=[],v=[],f=[],t.prev=6,t.next=9,Promise.all([n.get("/api/travels"),n.get("/api/articles"),n.get("/api/categories")]);case 9:m=t.sent,h=Object(c.a)(m,3),y=h[0],_=h[1],x=h[2],d=y.data,v=_.data,f=x.data,t.next=22;break;case 19:t.prev=19,t.t0=t.catch(6),console.warn(t.t0);case 22:return t.abrupt("return",{locale:o,otherLocale:l,travels:d,articles:v,categories:f});case 23:case"end":return t.stop()}}),t,null,[[6,19]])})))()},data:function(){return{columns:["title","countries","desc","steps","published","actions"],categoriesColumns:["label","name","actions"],travelToDelete:null,categoryToEdit:{},categoryToDelete:null}},computed:f({},Object(l.c)("modal",["modalId"])),methods:f(f({},Object(l.b)("modal",["setVisible","setModalId"])),{},{reloadData:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var r,n,o,l,d;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Promise.all([e.$axios.get("/api/travels"),e.$axios.get("/api/articles"),e.$axios.get("/api/categories")]);case 3:r=t.sent,n=Object(c.a)(r,3),o=n[0],l=n[1],d=n[2],e.travels=o?o.data:[],e.articles=l?l.data:[],e.categories=d?d.data:[],t.next=16;break;case 13:t.prev=13,t.t0=t.catch(0),console.warn(t.t0);case 16:case"end":return t.stop()}}),t,null,[[0,13]])})))()},getTravelSteps:function(e){var t=this;return this.articles.filter((function(t){return t.article_travel_id===e.travel_id})).map((function(a){return'<a href="/articles/'.concat(a.article_id,'">').concat(a["article_place_".concat(t.locale)],"</a>")})).join(", ")},getColumnValue:function(col,e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"travel";switch(col){case"steps":return this.getTravelSteps(e);case"countries":var r=e["".concat(t,"_").concat(col,"_").concat(this.locale)]||[];return r.join(", ");case"published":return e["".concat(t,"_").concat(col,"_").concat(this.locale)]?Object(d.a)(new Date(e["".concat(t,"_published_date_").concat(this.locale)]),"dd/MM/yyyy"):"";case"name":return e["".concat(t,"_").concat(col)];default:return e["".concat(t,"_").concat(col,"_").concat(this.locale)]?e["".concat(t,"_").concat(col,"_").concat(this.locale)]:'<span class="italic text-gray-500">'.concat(e["".concat(t,"_").concat(col,"_").concat(this.otherLocale)],"</span>")}},goToCategory:function(e){this.$router.push("/categories/".concat(e))},openRemoveModal:function(e,t){"travel"===e?(this.travelToDelete=t,this.setModalId("remove-travel")):(this.categoryToDelete=t,this.setModalId("remove-category")),this.setVisible(!0)},closeRemoveModal:function(){this.setModalId(null),this.setVisible(!1)},removeEntity:function(){var e=arguments,t=this;return Object(o.a)(regeneratorRuntime.mark((function r(){var n,c;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=e.length>0&&void 0!==e[0]?e[0]:"travel",c={travel:{endpoint:"travels",i18n:"travel",id:t.travelToDelete?t.travelToDelete.travel_id:""},category:{endpoint:"categories",i18n:"categories",id:t.categoryToDelete?t.categoryToDelete.category_id:""}},r.prev=2,r.next=5,t.$axios.delete("/api/".concat(c[n].endpoint,"/").concat(c[n].id));case 5:t.$toast.success(t.$t("".concat(c[n].i18n,".remove.success"))),t.closeRemoveModal(),t.travelToDelete=null,t.reloadData(),r.next=15;break;case 11:r.prev=11,r.t0=r.catch(2),console.warn(r.t0),t.$toast.error(t.$t("".concat(c[n].i18n,".remove.error")));case 15:case"end":return r.stop()}}),r,null,[[2,11]])})))()},saveCategory:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e.category_id){r.next=13;break}return r.prev=1,r.next=4,t.$axios.post("/api/categories",e);case 4:t.$toast.success(t.$t("categories.save.success")),t.reloadData(),r.next=11;break;case 8:r.prev=8,r.t0=r.catch(1),t.$toast.error(t.$t("categories.save.error"));case 11:r.next=23;break;case 13:return r.prev=13,r.next=16,t.$axios.put("/api/categories/".concat(e.category_id),e);case 16:t.$toast.success(t.$t("categories.save.success")),t.reloadData(),r.next=23;break;case 20:r.prev=20,r.t1=r.catch(13),t.$toast.error(t.$t("categories.save.error"));case 23:case"end":return r.stop()}}),r,null,[[1,8],[13,20]])})))()},openNewTravel:function(){this.$router.push("/travels/new")},openEditCategory:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.categoryToEdit=e,this.setModalId("category-edit"),this.setVisible(!0)}})},h=r(24),component=Object(h.a)(m,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("section",{staticClass:"travels-page flex flex-wrap justify-between"},[r("div",{staticClass:"sidebar"}),e._v(" "),r("div",{staticClass:"travels-page__container m-4"},[r("table",{staticClass:"table-fixed"},[r("thead",{staticClass:"border-t-2 border-blue-500"},[r("tr",e._l(e.columns,(function(col){return r("th",{key:col,class:{"px-4 py-2":!0,"w-1/4":"desc"!==col,"w-1/2":"desc"===col}},[e._v("\n            "+e._s(e.$t("travels."+col))+"\n          ")])})),0)]),e._v(" "),r("tbody",e._l(e.travels,(function(t,i){return r("tr",{key:t.travel_id,class:{"bg-gray-200":i%2==0}},e._l(e.columns,(function(col,n){return r("td",{key:col+"-"+n,staticClass:"border-b-2 border px-4 py-2"},["actions"!==col?r("div",{domProps:{innerHTML:e._s(e.getColumnValue(col,t))}}):r("div",{staticClass:"flex justify-between"},[r("nuxt-link",{attrs:{to:"/travels/"+t.travel_id}},[r("Icon",{attrs:{name:"pencil"}})],1),e._v(" "),r("Icon",{attrs:{name:"bin"},on:{click:function(r){return e.openRemoveModal("travel",t)}}})],1)])})),0)})),0)]),e._v(" "),r("div",{staticClass:"flex justify-end w-full my-4"},[r("Btn",{attrs:{"icon-btn":"",icon:"plus"},on:{click:e.openNewTravel}})],1)]),e._v(" "),"remove-travel"===e.modalId?r("RemoveModal",{on:{confirm:e.removeEntity,cancel:e.closeRemoveModal}}):e._e(),e._v(" "),r("div",{staticClass:"categories-page__container m-4"},[r("table",{staticClass:"table-fixed"},[r("thead",{staticClass:"border-t-2 border-blue-500"},[r("tr",e._l(e.categoriesColumns,(function(col){return r("th",{key:col,class:{"px-4 py-2":!0,"w-1/4":"desc"!==col,"w-1/2":"desc"===col}},[e._v("\n            "+e._s(e.$t("categories."+col))+"\n          ")])})),0)]),e._v(" "),r("tbody",e._l(e.categories,(function(t,i){return r("tr",{key:t.category_id,class:{"bg-gray-200":i%2==0}},e._l(e.categoriesColumns,(function(col,n){return r("td",{key:col+"-"+n,staticClass:"border-b-2 border px-4 py-2"},["actions"!==col?r("div",{domProps:{innerHTML:e._s(e.getColumnValue(col,t,"category"))}}):r("div",{staticClass:"flex justify-between"},[r("Icon",{staticClass:"mx-4",attrs:{name:"pencil"},on:{click:function(r){return e.goToCategory(t.category_id)}}})],1)])})),0)})),0)]),e._v(" "),r("div",{staticClass:"flex justify-end w-full my-4"},[r("Btn",{attrs:{"icon-btn":"",icon:"plus"},on:{click:function(t){return e.goToCategory("new")}}})],1)])],1)}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{Icon:r(288).default,Btn:r(287).default,RemoveModal:r(294).default})}}]);