(window.webpackJsonp=window.webpackJsonp||[]).push([[50,11,13,19],{473:function(e,t,n){"use strict";var r=n(2),o=n(475);r({target:"String",proto:!0,forced:n(476)("small")},{small:function(){return o(this,"small","","")}})},475:function(e,t,n){var r=n(4),o=n(41),c=n(16),l=/"/g,d=r("".replace);e.exports=function(e,t,n,r){var m=c(o(e)),f="<"+t;return""!==n&&(f+=" "+n+'="'+d(c(r),l,"&quot;")+'"'),f+">"+m+"</"+t+">"}},476:function(e,t,n){var r=n(3);e.exports=function(e){return r((function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3}))}},481:function(e,t,n){"use strict";n.r(t);n(25),n(18),n(39),n(20),n(40);var r=n(13),o=(n(30),n(11),n(470)),c=n(31);function l(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function d(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?l(Object(source),!0).forEach((function(t){Object(r.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):l(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var m={props:{assets:o.a.array.def([]),picked:o.a.oneOfType([o.a.object,o.a.array]).def(null),pick:o.a.string.def("one"),pickLimit:o.a.number.def(null),data:o.a.object.def(null)},data:function(){return{pickedImage:null,pickedImages:[]}},mounted:function(){this.picked&&("one"===this.pick?this.pickedImage=this.picked:"multiple"===this.pick&&(this.pickedImages=this.picked))},methods:d(d({},Object(c.b)("modal",["setVisible","setModalId"])),{},{handlePick:function(image){this.pickedImage=image},handlePicks:function(e,t,n){"add"===n?this.pickedImages.push(t):this.pickedImages=this.pickedImages.filter((function(a){return a.asset_id!==t.asset_id}))},handleConfirm:function(){var e="one"===this.pick?this.pickedImage:this.pickedImages;this.$emit("confirm",e),this.setModalId(null),this.setVisible(!1)},handleCancel:function(){this.setModalId(null),this.setVisible(!1)}})},f=n(36),component=Object(f.a)(m,(function(){var e=this,t=e._self._c;return t("portal",{attrs:{to:"modal"}},[t("div",{staticClass:"relative h-full"},["one"===e.pick&&e.pickedImage?t("div",{staticClass:"m-8"},[t("img",{staticClass:"h-48",attrs:{src:e.pickedImage.asset_src}})]):"multiple"===e.pick&&e.pickedImages?t("div",{staticClass:"m-8 flex flex-wrap"},e._l(e.pickedImages,(function(img){return t("div",{key:img.asset_id,staticClass:"mr-4"},[t("img",{staticClass:"h-32 m-2",attrs:{src:img.asset_src}})])})),0):e._e(),e._v(" "),t("AssetPickerLibrary",{attrs:{assets:e.assets,picked:e.picked,pick:e.pick,"pick-limit":e.pickLimit,data:e.data},on:{pick:e.handlePick,picks:e.handlePicks}}),e._v(" "),t("div",{staticClass:"sticky bottom-0 w-full translate-x-0 p-2 bg-white border-t-2 border-gray-500"},[t("div",{staticClass:"flex justify-end"},[t("Btn",{attrs:{label:e.$t("general.confirm")},on:{click:e.handleConfirm}}),e._v(" "),t("Btn",{attrs:{label:e.$t("general.cancel"),type:"secondary"},on:{click:e.handleCancel}})],1)])],1)])}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{AssetPickerLibrary:n(495).default,Btn:n(471).default})},512:function(e,t,n){"use strict";n.r(t);var r=n(470),o={props:{isNew:r.a.bool.def(!1),isPublished:r.a.bool.def(!1),saveOnly:r.a.bool.def(!1),canRemove:r.a.bool.def(!1)}},c=n(36),component=Object(c.a)(o,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"flex justify-center items-center"},[t("div",{class:[{"w-2/3":!e.saveOnly,"mx-8":e.saveOnly},"flex flex-col items-end"]},[t("div",{staticClass:"flex mt-8 mb-24"},[t("Btn",{attrs:{"icon-btn":"",label:e.$t("general.save"),icon:"floppy-disk"},on:{click:function(t){return e.$emit("save")}}}),e._v(" "),e.saveOnly&&e.canRemove?t("span",[e.isNew?e._e():t("Btn",{attrs:{"icon-btn":"",label:e.$t("general.remove"),icon:"bin"},on:{click:function(t){return e.$emit("remove")}}})],1):e._e(),e._v(" "),e.saveOnly?e._e():t("span",[t("Btn",{attrs:{"icon-btn":"",label:e.$t("general.publish"),icon:"rocket"},on:{click:function(t){return e.$emit("publish")}}}),e._v(" "),e.isNew?e._e():t("Btn",{attrs:{"icon-btn":"",label:e.$t("general.remove"),icon:"bin"},on:{click:function(t){return e.$emit("remove")}}}),e._v(" "),e.isPublished?t("Btn",{attrs:{"icon-btn":"",type:"error",label:e.$t("general.unpublish"),icon:"fire"},on:{click:function(t){return e.$emit("unpublish")}}}):e._e()],1)],1),e._v(" "),e._t("default"),e._v(" "),t("div",{staticClass:"flex mt-24 mb-8"},[t("Btn",{attrs:{"icon-btn":"",label:e.$t("general.save"),icon:"floppy-disk"},on:{click:function(t){return e.$emit("save")}}}),e._v(" "),e.saveOnly&&e.canRemove?t("span",[e.isNew?e._e():t("Btn",{attrs:{"icon-btn":"",label:e.$t("general.remove"),icon:"bin"},on:{click:function(t){return e.$emit("remove")}}})],1):e._e(),e._v(" "),e.saveOnly?e._e():t("span",[t("Btn",{attrs:{"icon-btn":"",label:e.$t("general.publish"),icon:"rocket"},on:{click:function(t){return e.$emit("publish")}}}),e._v(" "),e.isNew?e._e():t("Btn",{attrs:{"icon-btn":"",label:e.$t("general.remove"),icon:"bin"},on:{click:function(t){return e.$emit("remove")}}}),e._v(" "),e.isPublished?t("Btn",{attrs:{"icon-btn":"",type:"error",label:e.$t("general.unpublish"),icon:"fire"},on:{click:function(t){return e.$emit("unpublish")}}}):e._e()],1)],1)],2)])}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{Btn:n(471).default})},518:function(e,t,n){"use strict";n.r(t);n(25),n(18),n(30),n(11),n(39),n(20),n(40);var r=n(13),o=n(470),c=n(31);function l(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function d(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?l(Object(source),!0).forEach((function(t){Object(r.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):l(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var m={props:{id:o.a.string.def(""),label:o.a.string.def("Choose an image"),image:o.a.object.def(null),assets:o.a.array.def([]),data:o.a.object.def(null)},data:function(){return{imageModel:null,realId:Math.floor(1e4*Math.random())}},computed:d({},Object(c.c)("modal",["visible","modalId"])),mounted:function(){this.image&&(this.imageModel=this.image),this.id&&(this.realId=this.id)},methods:d(d({},Object(c.b)("modal",["setVisible","setModalId"])),{},{openModal:function(){this.setVisible(!0),this.setModalId("pick-image-".concat(this.id))},confirmImage:function(image){this.imageModel=image,this.$emit("change",image)}})},f=n(36),component=Object(f.a)(m,(function(){var e=this,t=e._self._c;return t("div",[e.label?t("h4",{staticClass:"label font-bold my-4"},[t("span",{staticClass:"bg-white z-10 pr-6"},[e._v(e._s(e.label))])]):e._e(),e._v(" "),t("div",[e.imageModel?t("div",{staticClass:"justify-self-center"},[t("img",{staticClass:"h-56",attrs:{src:e.imageModel.asset_src}})]):e._e(),e._v(" "),t("div",{staticClass:"flex justify-end w-full"},[t("Btn",{attrs:{"icon-btn":"",icon:e.image?"pencil":"plus"},on:{click:e.openModal}})],1),e._v(" "),e.modalId==="pick-image-".concat(e.id)?t("AssetsModal",{attrs:{assets:e.assets,picked:e.imageModel,data:e.data},on:{confirm:e.confirmImage}}):e._e()],1)])}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{Btn:n(471).default,AssetsModal:n(481).default})},596:function(e,t,n){"use strict";n.r(t);n(26),n(25),n(18),n(30),n(39),n(20),n(40);var r=n(13),o=n(12),c=n(6),l=(n(52),n(11),n(32),n(33),n(138),n(31));function d(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function m(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?d(Object(source),!0).forEach((function(t){Object(r.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):d(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var f={asyncData:function(e){return Object(c.a)(regeneratorRuntime.mark((function t(){var n,r,c,l,d,m,f,v,h,_,y,k,O,j,w;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.$axios,r=e.route,c=e.app,l=[],d=[],m=[],t.prev=4,!r.params.id||"new"===r.params.id){t.next=10;break}return t.next=8,n.get("/api/categories/".concat(r.params.id));case 8:v=t.sent,f=v?v.data:null;case 10:return t.next=12,Promise.all([n.get("/api/assets"),n.get("/api/travels"),n.get("/api/articles")]);case 12:return h=t.sent,_=Object(o.a)(h,3),y=_[0],k=_[1],O=_[2],l=y.data,d=k.data,m=O.data,j=c.i18n.locale,w=f?{name:f.category_name,label:f["category_label_".concat(j)],asset_desktop:f["category_asset_".concat(j)]?l.find((function(a){return a.asset_id===f["category_asset_".concat(j)]})):null,asset_mobile:f["category_asset_mobile_".concat(j)]?l.find((function(a){return a.asset_id===f["category_asset_mobile_".concat(j)]})):null}:{name:"",label:"",asset_desktop:null,asset_mobile:null},t.abrupt("return",{category:f,model:w,lang:j,assets:l,travels:d,articles:m,isNew:!f,mounted:!1});case 25:t.prev=25,t.t0=t.catch(4),console.warn(t.t0);case 28:case"end":return t.stop()}}),t,null,[[4,25]])})))()},computed:m({},Object(l.c)("modal",["modalId"])),mounted:function(){this.mounted=!0},methods:m(m({},Object(l.b)("modal",["setVisible","setModalId"])),{},{reloadData:function(){var e=this;return Object(c.a)(regeneratorRuntime.mark((function t(){var n,data;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$axios.get("/api/categories/".concat(e.$route.params.id));case 3:n=t.sent,data=n.data,e.category=data,e.model={name:data.category_name,label:data["category_label_".concat(e.lang)],asset_desktop:data["category_asset_".concat(e.lang)],asset_mobile:data["category_asset_mobile_".concat(e.lang)]},t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),console.warn(t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})))()},handleCoverChange:function(e,t){this.model["asset_".concat(t)]=e},openRemoveModal:function(){this.setModalId("remove-category"),this.setVisible(!0)},saveCategory:function(){var e=this;return Object(c.a)(regeneratorRuntime.mark((function t(){var n,o,c,data;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((o=m(m({},e.category),{},(n={category_name:e.model.name},Object(r.a)(n,"category_label_".concat(e.lang),e.model.label),Object(r.a)(n,"category_asset_".concat(e.lang),e.model.asset_desktop?e.model.asset_desktop.asset_id:null),Object(r.a)(n,"category_asset_mobile_".concat(e.lang),e.model.asset_mobile?e.model.asset_mobile.asset_id:null),n))).category_id){t.next=16;break}return t.prev=2,t.next=5,e.$axios.post("/api/categories",o);case 5:c=t.sent,data=c.data,e.$toast.success(e.$t("categories.save.success")),e.$router.push("/categories/".concat(data[0].category_id)),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(2),e.$toast.error(e.$t("categories.save.error"));case 14:t.next=26;break;case 16:return t.prev=16,t.next=19,e.$axios.put("/api/categories/".concat(o.category_id),o);case 19:e.$toast.success(e.$t("categories.save.success")),e.reloadData(),t.next=26;break;case 23:t.prev=23,t.t1=t.catch(16),e.$toast.error(e.$t("categories.save.error"));case 26:case"end":return t.stop()}}),t,null,[[2,11],[16,23]])})))()},removeCategory:function(){var e=this;return Object(c.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$axios.delete("/api/categories/".concat(e.category.category_id));case 3:e.$toast.success(e.$t("categories.delete.success")),e.$router.push("/travels"),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),e.$toast.error(e.$t("categories.delete.error"));case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()}})},v=n(36),component=Object(v.a)(f,(function(){var e=this,t=e._self._c;return t("EntityActions",{attrs:{"save-only":"","can-remove":"","is-new":e.isNew},on:{save:e.saveCategory,remove:e.openRemoveModal}},[e.mounted?t("div",[t("div",{staticClass:"m-8"},[t("InputText",{attrs:{label:e.$t("categories.name")},model:{value:e.model.name,callback:function(t){e.$set(e.model,"name",t)},expression:"model.name"}}),e._v(" "),t("InputText",{attrs:{label:e.$t("categories.label")},model:{value:e.model.label,callback:function(t){e.$set(e.model,"label",t)},expression:"model.label"}}),e._v(" "),t("ChooseImage",{attrs:{id:"desktop",image:e.model.asset_desktop,assets:e.assets,data:{travels:e.travels,articles:e.articles},label:e.$t("article.cover_desktop")},on:{change:function(t){return e.handleCoverChange(t,"desktop")}}}),e._v(" "),t("ChooseImage",{attrs:{id:"mobile",image:e.model.asset_mobile,assets:e.assets,data:{travels:e.travels,articles:e.articles},label:e.$t("article.cover_mobile")},on:{change:function(t){return e.handleCoverChange(t,"mobile")}}})],1)]):e._e(),e._v(" "),"remove-category"===e.modalId?t("RemoveModal",{on:{confirm:e.removeCategory,cancel:e.closeModal}}):e._e()],1)}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{InputText:n(474).default,ChooseImage:n(518).default,RemoveModal:n(484).default,EntityActions:n(512).default})}}]);