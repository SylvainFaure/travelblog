(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{287:function(e,t,l){"use strict";l.r(t);l(62);var r=l(286),n={props:{type:r.a.string.def("primary"),label:r.a.string.def("Save"),iconBtn:r.a.bool.def(!1),icon:r.a.string.def("checkmark"),additionalClasses:r.a.string.def("")},computed:{classes:function(){var e=this.iconBtn?"px-4 py-2":"p-2";return"cursor-pointer bg-".concat(this.type||"primary"," ").concat("raw"===this.type?"":"border text-white"," ").concat(e)}}},c=l(24),component=Object(c.a)(n,(function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("button",{class:[e.classes,e.additionalClasses,"rounded text-center flex items-center"],attrs:{type:"button"},on:{click:function(t){return e.$emit("click")}}},[e.iconBtn?e._e():l("span",[e._v(e._s(e.label))]),e._v(" "),e.icon&&!e.iconBtn?l("span",{staticClass:"pl-2"},[l("Icon",{attrs:{name:e.icon}})],1):l("span",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.label,expression:"label"}]},[l("Icon",{attrs:{name:e.icon}})],1)])}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{Icon:l(288).default})},288:function(e,t,l){"use strict";l.r(t);var r=l(286),n={props:{name:r.a.string.def(""),small:r.a.bool.def(!1)}},c=l(24),component=Object(c.a)(n,(function(){var e=this.$createElement,t=this._self._c||e;return t("svg",this._g({class:{"fill-current icon":!0,"cursor-pointer":!!this.$listeners,"w-2 h-2":this.small,"w-4 h-4":!this.small}},this.$listeners),[t("use",{attrs:{"xlink:href":"#icon-"+this.name}})])}),[],!1,null,null,null);t.default=component.exports},290:function(e,t,l){"use strict";l.r(t);var r=l(286),n={props:{type:r.a.string.def("text"),name:r.a.string.def("input"),id:r.a.string.def("input"),label:r.a.string.def(""),placeholder:r.a.string.def(""),required:r.a.bool.def(!1),disabled:r.a.bool.def(!1),value:r.a.string.def(""),small:r.a.bool.def(!1)}},c=l(24),component=Object(c.a)(n,(function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{class:{"mt-2 mb-4":!e.small}},[e.label?l("h4",{staticClass:"label font-bold my-4"},[l("span",{staticClass:"bg-white z-10 pr-6"},[e._v(e._s(e.label))])]):e._e(),e._v(" "),l("input",{class:[e.small?"text-xs":"","w-full p-2 rounded border"],attrs:{id:e.id,type:e.type,name:e.name,required:e.required,disabled:e.disabled,placeholder:e.placeholder},domProps:{value:e.value},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.$emit("enter")},input:function(t){return e.$emit("input",t.target.value)}}})])}),[],!1,null,null,null);t.default=component.exports},294:function(e,t,l){"use strict";l.r(t);var r={},n=l(24),component=Object(n.a)(r,(function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("portal",{attrs:{to:"modal"}},[l("div",{staticClass:"flex flex-col justify-center items-center m-16"},[l("h4",{staticClass:"font-bold text-lg text-center mb-4"},[e._v(e._s(e.$t("general.sure")))]),e._v(" "),l("div",{staticClass:"flex justify-center"},[l("Btn",{attrs:{label:e.$t("general.confirm"),"additional-classes":"mr-4"},on:{click:function(t){return e.$emit("confirm")}}}),e._v(" "),l("Btn",{attrs:{label:e.$t("general.cancel"),type:"secondary"},on:{click:function(t){return e.$emit("cancel")}}})],1)])])}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{Btn:l(287).default})},295:function(e,t,l){"use strict";l.r(t);var r=l(318),n=l.n(r),c=l(286),o=(l(319),{components:{vSelect:n.a},props:{label:c.a.string.def(null),sublabel:c.a.string.def(null),placeholder:c.a.string.def(null),options:c.a.array.def([]),optionLabel:c.a.string.def("label"),multiple:c.a.bool.def(!1),taggable:c.a.bool.def(!1),pushTags:c.a.bool.def(!1),value:c.a.oneOfType([c.a.object,c.a.array]).def(null),small:c.a.bool.def(!1)}}),d=(l(321),l(24)),component=Object(d.a)(o,(function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",[e.label?l("h4",{staticClass:"label font-bold my-4"},[l("span",{staticClass:"bg-white z-10 pr-6"},[e._v(e._s(e.label))])]):e._e(),e._v(" "),e.sublabel?l("p",[e._v(e._s(e.sublabel))]):e._e(),e._v(" "),l("v-select",{attrs:{options:e.options,label:e.optionLabel,multiple:e.multiple,taggable:e.taggable,"push-tags":e.pushTags,placeholder:e.placeholder,value:e.value},on:{input:function(t){return e.$emit("input",t)}}})],1)}),[],!1,null,null,null);t.default=component.exports},297:function(e,t,l){var content=l(322);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,l(61).default)("2bea4cae",content,!0,{sourceMap:!1})},298:function(e,t,l){var content=l(324);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,l(61).default)("fba0ba2a",content,!0,{sourceMap:!1})},300:function(e,t,l){"use strict";l.r(t);var r=l(286),n={props:{name:r.a.string.def("textarea"),placeholder:r.a.string.def(""),label:r.a.string.def(null),required:r.a.bool.def(!1),rows:r.a.number.def(4),value:r.a.string.def(""),classes:r.a.string.def("")}},c=l(24),component=Object(c.a)(n,(function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",[e.label?l("h4",{staticClass:"label font-bold my-4"},[l("span",{staticClass:"bg-white z-10 pr-6"},[e._v(e._s(e.label))])]):e._e(),e._v(" "),l("textarea",{class:[e.classes,"w-full p-2 rounded border border-grey-600"],attrs:{name:e.name,placeholder:e.placeholder,required:e.required,rows:e.rows},domProps:{value:e.value},on:{input:function(t){return e.$emit("input",t.target.value)}}})])}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{Textarea:l(300).default})},304:function(e,t,l){var content=l(331);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,l(61).default)("f280b1c0",content,!0,{sourceMap:!1})},316:function(e,t,l){"use strict";l.r(t);l(62);var r=l(286),n={props:{deletable:r.a.bool.def(!1),selectable:r.a.bool.def(!1),selected:r.a.bool.def(!1),tag:r.a.string.def("")},computed:{color:function(){var e=["gray","indigo","red","orange","yellow","green","teal","blue","purple","pink"];return"".concat(this.selectable&&!this.selected?"border-2 border-":"text-white bg-").concat(e[Math.floor(Math.random()*(e.length-1))],"-500")}}},c=l(24),component=Object(c.a)(n,(function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{class:[e.color,"text-xs rounded-md px-2 py-1",{"cursor-pointer":e.selectable}],on:{click:function(t){return e.$emit("click")}}},[l("span",[e._v(e._s(e.tag?"#"+e.tag:"# No place"))]),e._v(" "),e.deletable?l("span",{staticClass:"cursor-pointer font-bold",on:{click:function(t){return e.$emit("remove",e.tag)}}},[e._v("x")]):e._e()])}),[],!1,null,null,null);t.default=component.exports},321:function(e,t,l){"use strict";var r=l(297);l.n(r).a},322:function(e,t,l){(t=l(60)(!1)).push([e.i,'.vs__dropdown-toggle{border-width:1px}.label{position:relative;overflow:hidden;display:flex;align-items:center}.label:after{content:"";position:absolute;padding-left:2px;width:100%;height:1px;background-color:#000}',""]),e.exports=t},323:function(e,t,l){"use strict";var r=l(298);l.n(r).a},324:function(e,t,l){(t=l(60)(!1)).push([e.i,".backdrop,.backdrop-content{transition:opacity .3s}.backdrop-container:hover>.backdrop,.backdrop-container:hover>.backdrop-content{opacity:1}.backdrop-container:hover>.backdrop{filter:blur(5px) grayscale(.7)}",""]),e.exports=t},325:function(e,t,l){"use strict";l.r(t);l(19),l(42),l(27),l(82),l(17),l(48),l(53),l(191),l(36),l(37),l(28),l(41),l(56),l(63),l(64),l(18),l(32);var r=l(4),n=l(9),c=l(374),o=l(286),d=l(20);function f(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(object);e&&(l=l.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,l)}return t}function v(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?f(Object(source),!0).forEach((function(t){Object(n.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):f(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var _={props:{assets:o.a.array.def([]),pick:o.a.string.def(null),picked:o.a.oneOfType([o.a.array,o.a.object]).def(null),data:o.a.object.def({}),pickLimit:o.a.number.def(null)},data:function(){var e=this.$i18n.locale;return{locale:e,otherLocale:"fr"===e?"it":"fr",pickedAsset:null,pickedAssetsIds:[],assetToRemove:null,assetToEdit:null,filters:{travel:null,place:null}}},computed:v(v({},Object(d.c)("modal",["modalId"])),{},{places:function(){var e=this;return this.data.articles.map((function(article){var t=article["article_place_".concat(e.locale)];if(t)return{key:t.toLowerCase().replaceAll(" ","_"),label:t}})).filter((function(e){return!!e}))},filteredAssets:function(){var e=this;return this.assets.filter((function(t){return e.filters.travel&&e.filters.place?e.filters.travel===Number(t.asset_travel_id)&&!!t["asset_place_".concat(e.locale)]&&e.filters.place===t["asset_place_".concat(e.locale)]:!e.filters.travel&&!e.filters.place||(e.filters.travel===Number(t.asset_travel_id)||e.filters.place===t["asset_place_".concat(e.locale)])}))}}),mounted:function(){var e=this;this.locale=this.$i18n.locale,this.picked&&("multiple"===this.pick?this.pickedAssetsIds=this.picked.map((function(p){return p.asset_id})):(this.pickedAsset=this.picked,this.$nextTick((function(){e.initWithPicked()}))))},methods:v(v({},Object(d.b)("modal",["setVisible","setModalId"])),{},{getUploadDate:function(e){var t=e.split("_")[0];return Object(c.a)(new Date(Number(t)),"dd/MM/yyyy")},getTravelTitle:function(e){var t=this.data.travels.find((function(t){return t.travel_id===e}));return t["travel_title_".concat(this.locale)]?t["travel_title_".concat(this.locale)]:'<span class="italic text-gray-400">'.concat(t["travel_title_".concat(this.otherLocale)],"</span>")},initWithPicked:function(){var e=this;this.$refs.asset.forEach((function(a){Number(a.getAttribute("id"))!==Number(e.pickedAsset.asset_id)?a.classList.add("opacity-50"):a.classList.remove("opacity-50")}))},handlePickOneAsset:function(e){var t=this;this.$refs.asset.forEach((function(a){t.pickedAsset&&t.pickedAsset.asset_id===e.asset_id?a.classList.remove("opacity-50"):Number(a.getAttribute("id"))!==Number(e.asset_id)?a.classList.add("opacity-50"):a.classList.remove("opacity-50")})),this.pickedAsset=e},handleAssetPick:function(e,t){var l,r=this;(t.stopPropagation(),t.preventDefault(),"one"===this.pick&&(this.handlePickOneAsset(e),this.$emit("pick",e)),"multiple"===this.pick)&&((!this.pickLimit||this.pickedAssetsIds.length<this.pickLimit||this.pickedAssetsIds.length===this.pickLimit&&!t.target.checked)&&(t.target.checked?(l="add",this.pickedAssetsIds.push(e.asset_id)):(l="remove",this.pickedAssetsIds=this.pickedAssetsIds.filter((function(a){return a!==e.asset_id}))),this.pickedAssetsIds.length===this.pickLimit?this.$refs.assetContainer.forEach((function(a){r.pickedAssetsIds.includes(Number(a.getAttribute("id").replace("container_","")))||(a.classList.add("pointer-events-none"),a.classList.add("opacity-50"))})):this.$refs.assetContainer.forEach((function(a){a.classList.remove("pointer-events-none"),a.classList.remove("opacity-50")})),this.$emit("picks",this.pickedAssetsIds,e,l)))},handleEdit:function(e){this.assetToEdit=e,this.setVisible(!0),this.setModalId("asset-edit")},handleRemove:function(e){this.assetToRemove=e,this.setVisible(!0),this.setModalId("asset-remove")},removeAsset:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$axios.post("/api/assets/delete",{ids:[e.assetToRemove.asset_id],names:[e.assetToRemove.asset_name]});case 3:e.$toast.success(e.$t("assets.removed_success")),e.$emit("change"),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0),e.$toast.error(e.$t("assets.removed_error"));case 11:return t.prev=11,e.closeRemoveModal(),e.assetToRemove=null,t.finish(11);case 15:case"end":return t.stop()}}),t,null,[[0,7,11,15]])})))()},updateAsset:function(e,t){var l=this;return Object(r.a)(regeneratorRuntime.mark((function r(){var c,o;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return o=v(v({},t),{},(c={},Object(n.a)(c,"asset_desc_".concat(l.locale),e.description),Object(n.a)(c,"asset_title_".concat(l.locale),e.title),Object(n.a)(c,"asset_article_ids",JSON.stringify(e.article_ids.map((function(e){return Number(e.article_id)})))),Object(n.a)(c,"asset_travel_id",Number(e.travel.travel_id)),c)),r.prev=1,r.next=4,l.$axios.put("/api/assets/".concat(t.asset_id),o);case 4:l.$toast.success(l.$t("assets.updated_success")),l.$emit("change"),l.assetToEdit=null,r.next=13;break;case 9:r.prev=9,r.t0=r.catch(1),console.log(r.t0),l.$toast.error(l.$t("assets.updated_error"));case 13:case"end":return r.stop()}}),r,null,[[1,9]])})))()},closeRemoveModal:function(){this.setVisible(!1),this.setModalId(null)},handleFilter:function(e){e.travel_id?this.filters.travel=this.filters.travel===e.travel_id?null:e.travel_id:this.filters.place=this.filters.place===e.label?null:e.label}})},m=(l(323),l(24)),component=Object(m.a)(_,(function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("section",[l("div",{staticClass:"m-6"},[l("div",{staticClass:"flex my-4"},[l("div",{staticClass:"w-1/2 flex flex-col items-center"},[l("h4",[e._v(e._s(e.$t("assets.filter_by_travel")))]),e._v(" "),l("div",{staticClass:"flex flex-wrap justify-center w-full"},e._l(e.data.travels,(function(t){return l("Tag",{key:t.travel_id,staticClass:"mr-2 my-2",attrs:{tag:t["travel_title_"+e.locale],selectable:"",selected:e.filters.travel===t.travel_id},on:{click:function(l){return e.handleFilter(t)}}})})),1)]),e._v(" "),l("div",{staticClass:"w-1/2 flex flex-col items-center"},[l("h4",[e._v(e._s(e.$t("assets.filter_by_place")))]),e._v(" "),l("div",{staticClass:"flex flex-wrap justify-center w-full"},e._l(e.places,(function(t){return l("Tag",{key:t.key,staticClass:"mr-2 my-2",attrs:{tag:t.label,selectable:"",selected:e.filters.place===t.label},on:{click:function(l){return e.handleFilter(t)}}})})),1)])]),e._v(" "),l("div",{staticClass:"flex flex-wrap justify-center"},[e._l(e.filteredAssets,(function(t,i){return l("div",{key:i,ref:"assetContainer",refInFor:!0,class:{"w-64 mr-4 my-2 relative":!0,"h-80 border border-grey-100":!e.pick},attrs:{id:"container_"+t.asset_id}},["multiple"===e.pick?l("span",{staticClass:"absolute top-0 right-0"},[l("input",{staticClass:"mr-2 mt-2 z-20",attrs:{type:"checkbox"},domProps:{checked:e.pickedAssetsIds.includes(t.asset_id)},on:{change:function(l){return e.handleAssetPick(t,l)}}})]):e._e(),e._v(" "),l("div",{class:{"backdrop-container max-h-2/3 overflow-hidden relative flex justify-center items-center":!e.pick}},[e.pick?e._e():l("div",{staticClass:"backdrop opacity-0 absolute inset-0 h-full w-full hover:opacity-100 transition-opacity duration-300 bg-blue-100 bg-opacity-50"}),e._v(" "),e.pick?e._e():l("div",{staticClass:"backdrop-content z-10 flex absolute inset-0 justify-center items-center opacity-0"},[l("Btn",{attrs:{"icon-btn":"",icon:"pencil"},on:{click:function(l){return e.handleEdit(t)}}}),e._v(" "),l("Btn",{attrs:{"icon-btn":"",type:"secondary",icon:"bin"},on:{click:function(l){return e.handleRemove(t)}}})],1),e._v(" "),l("img",{ref:"asset",refInFor:!0,class:{"max-h-2/3":!e.pick,"cursor-pointer":e.pick,"w-full overflow-hidden":!0},attrs:{id:t.asset_id,src:t.asset_src},on:{click:function(l){return e.handleAssetPick(t,l)}}})]),e._v(" "),e.pick?e._e():l("div",{staticClass:"asset__infos p-4"},[t["asset_title_"+e.$i18n.locale]?l("p",{staticClass:"font-bold text-lg"},[e._v("\n            "+e._s(t["asset_title_"+e.$i18n.locale])+"\n          ")]):e._e(),e._v(" "),t["asset_place_"+e.$i18n.locale]?l("p",{staticClass:"font-bold text-sm"},[e._v("\n            "+e._s(t["asset_place_"+e.$i18n.locale])+"\n          ")]):e._e(),e._v(" "),l("p",{staticClass:"text-sm text-gray-600"},[e._v("\n            "+e._s(e.$t("assets.uploaded"))+"\n            "+e._s(e.getUploadDate(t.asset_name))+"\n          ")]),e._v(" "),t["asset_desc_"+e.$i18n.locale]?l("p",{staticClass:"text-sm text-gray-600"},[e._v("\n            "+e._s(e.$t("assets.description"))+"\n            "+e._s(t["asset_desc_"+e.$i18n.locale])+"\n          ")]):e._e(),e._v(" "),t.asset_travel_id?l("p",{staticClass:"text-sm text-gray-600 font-bold",domProps:{innerHTML:e._s(e.getTravelTitle(t.asset_travel_id))}}):e._e()])])})),e._v(" "),e.filteredAssets.length?e._e():l("div",{staticClass:"flex justify-center max-w-1/4 my-16"},[e._v("\n        "+e._s(e.$t("assets.filtered_empty"))+"\n      ")])],2),e._v(" "),"asset-remove"===e.modalId?l("RemoveModal",{on:{confirm:e.removeAsset,cancel:e.closeRemoveModal}}):e._e(),e._v(" "),"asset-edit"===e.modalId?l("EditAssetModal",{attrs:{travels:e.data.travels,articles:e.data.articles,image:e.assetToEdit},on:{confirm:e.updateAsset,cancel:e.closeRemoveModal}}):e._e()],1)])}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{Tag:l(316).default,Btn:l(287).default,RemoveModal:l(294).default,EditAssetModal:l(327).default})},327:function(e,t,l){"use strict";l.r(t);l(19),l(27),l(82),l(17),l(48),l(36),l(37),l(28),l(56),l(18);var r=l(9),n=l(286),c=l(20);function o(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(object);e&&(l=l.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,l)}return t}function d(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?o(Object(source),!0).forEach((function(t){Object(r.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):o(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var f={props:{image:n.a.object.def(null),articles:n.a.array.def([]),travels:n.a.array.def([])},data:function(){return{locale:"",model:{name:"",title:"",place:"",description:"",article_ids:[],travel:null}}},mounted:function(){var e=this.$i18n.locale;this.locale=e;var t=this.image,l=t.asset_name,r=t.asset_article_ids,n=t.asset_travel_id;this.model={name:l,title:this.image["asset_title_".concat(e)],place:this.image["asset_place_".concat(e)],description:this.image["asset_desc_".concat(e)],article_ids:r?this.articles.filter((function(article){return r.includes(article.article_id)})):[],travel:n?this.travels.find((function(e){return e.travel_id===n})):null}},methods:d(d({},Object(c.b)("modal",["setVisible","setModalId"])),{},{handleConfirm:function(){this.$emit("confirm",this.model,this.image),this.closeModal()},handleCancel:function(){this.closeModal()},closeModal:function(){this.setModalId(null),this.setVisible(!1)},handleReduce:function(option){return option["article_title_".concat(this.locale)]}})},v=l(24),component=Object(v.a)(f,(function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("portal",{attrs:{to:"modal"}},[l("div",[l("div",{staticClass:"h-full flex"},[l("div",{staticClass:"m-8"},[l("img",{staticClass:"h-48",attrs:{src:e.image.asset_src}})]),e._v(" "),l("div",{staticClass:"mr-8 mb-8 w-full max-w-2/3"},[l("InputText",{attrs:{label:e.$t("assets.edit.name"),disabled:""},model:{value:e.model.name,callback:function(t){e.$set(e.model,"name",t)},expression:"model.name"}}),e._v(" "),l("InputText",{attrs:{label:e.$t("assets.edit.title")},model:{value:e.model.title,callback:function(t){e.$set(e.model,"title",t)},expression:"model.title"}}),e._v(" "),l("InputText",{attrs:{label:e.$t("assets.edit.place")},model:{value:e.model.place,callback:function(t){e.$set(e.model,"place",t)},expression:"model.place"}}),e._v(" "),l("Textarea",{attrs:{label:e.$t("assets.edit.description")},model:{value:e.model.description,callback:function(t){e.$set(e.model,"description",t)},expression:"model.description"}}),e._v(" "),l("Select",{attrs:{multiple:"",label:e.$t("assets.edit.articles"),options:e.articles,"option-label":"article_title_"+e.locale},model:{value:e.model.article_ids,callback:function(t){e.$set(e.model,"article_ids",t)},expression:"model.article_ids"}}),e._v(" "),l("Select",{attrs:{label:e.$t("assets.edit.travel"),options:e.travels,"option-label":"travel_title_"+e.locale},model:{value:e.model.travel,callback:function(t){e.$set(e.model,"travel",t)},expression:"model.travel"}})],1)]),e._v(" "),l("div",{staticClass:"sticky bottom-0 w-full translate-x-0 p-2 bg-white border-t-2 border-gray-500"},[l("div",{staticClass:"flex justify-end"},[l("Btn",{attrs:{label:e.$t("general.confirm")},on:{click:e.handleConfirm}}),e._v(" "),l("Btn",{attrs:{label:e.$t("general.cancel"),type:"secondary"},on:{click:e.handleCancel}})],1)])])])}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{InputText:l(290).default,Textarea:l(300).default,Select:l(295).default,Btn:l(287).default})},330:function(e,t,l){"use strict";var r=l(304);l.n(r).a},331:function(e,t,l){(t=l(60)(!1)).push([e.i,".loader{border:16px solid #f3f3f3;border-top-color:#3498db;border-radius:50%;width:120px;height:120px;-webkit-animation:spin 2s linear infinite;animation:spin 2s linear infinite}",""]),e.exports=t},341:function(e,t,l){"use strict";l.r(t);var r={},n=(l(330),l(24)),component=Object(n.a)(r,(function(){var e=this.$createElement;this._self._c;return this._m(0)}),[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"w-screen h-screen fixed bg-gray-200 inset-0 flex justify-center items-center z-50"},[t("div",{staticClass:"loader animation-spin"})])}],!1,null,null,null);t.default=component.exports},364:function(e,t,l){"use strict";l.r(t);l(19),l(27),l(17),l(53),l(36),l(37),l(28),l(18);var r=l(9);function n(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(object);e&&(l=l.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,l)}return t}function c(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?n(Object(source),!0).forEach((function(t){Object(r.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):n(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var o={props:{tabs:l(286).a.array.def([])},data:function(){return{mappedTabs:[]}},mounted:function(){this.mappedTabs=this.tabs.map((function(e,i){return c(c({},e),{},{active:0===i})}))},methods:{handleTabClick:function(e){this.$emit("tab",e),this.mappedTabs=this.mappedTabs.map((function(t){return c(c({},t),{},{active:t.key===e.key})}))}}},d=l(24),component=Object(d.a)(o,(function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticClass:"flex m-6"},e._l(e.mappedTabs,(function(t){return l("div",{key:t.key,class:{"font-bold border-b-2 border-gray-400":t.active,"cursor-pointer mr-8 py-2":!0},on:{click:function(l){return e.handleTabClick(t)}}},[e._v("\n    "+e._s(t.name)+"\n  ")])})),0)}),[],!1,null,null,null);t.default=component.exports},365:function(e,t,l){"use strict";l.r(t);l(19),l(62),l(27),l(17),l(21),l(36),l(37),l(28),l(16),l(38),l(18),l(40),l(346),l(32);var r=l(4),n=l(9),c=l(286),o=l(350);function d(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(object);e&&(l=l.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,l)}return t}var f={components:{FileUpload:l.n(o).a},props:{travels:c.a.array.def([])},data:function(){return{loading:!1,files:[],filesData:[]}},methods:{handleUpload:function(){this.$refs.upload.active=!0,this.loading=!0},handleFillEverything:function(e,t){this.filesData.forEach((function(l){l[t]=e}))},inputFile:function(e,t){(!t||e&&t.name!==e.name)&&(console.log("PUSH NEW FILE DATA"),this.filesData.push(function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?d(Object(source),!0).forEach((function(t){Object(n.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):d(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}({id:e.id,name:e.name},{title_fr:"",title_it:"",place_fr:"",place_it:"",country_fr:"",country_it:"",desc_fr:"",desc_it:"",travel_id:""}))),e&&t&&!e.active&&t.active&&e.xhr},inputFilter:function(e,t,l){if(e&&!t&&!/\.(jpeg|jpe|jpg|gif|png|webp)$/i.test(e.name))return l();e.blob="";var r=window.URL||window.webkitURL;r&&r.createObjectURL&&(e.blob=r.createObjectURL(e.file))},uploadFiles:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return l=new FormData,e.files.forEach((function(t,r){l.append("file[".concat(r,"]"),t.file),Object.keys(e.filesData[r]).forEach((function(t,i){var n="travel_id"===t?e.filesData[r][t].travel_id:e.filesData[r][t];l.append("infos[".concat(r,"][").concat(t,"]"),n)}))})),t.prev=2,t.next=5,e.$axios.post("/api/asset",l,{headers:{"Content-Type":"multipart/form-data"}});case 5:e.files=[],e.filesData=[],e.$toast.success(e.$t("assets.upload_success")),e.$emit("uploaded"),t.next=15;break;case 11:t.prev=11,t.t0=t.catch(2),console.log("ERROR",t.t0),e.$toast.error(e.$t("assets.upload_error"));case 15:return t.prev=15,e.loading=!1,t.finish(15);case 18:case"end":return t.stop()}}),t,null,[[2,11,15,18]])})))()}}},v=l(24),component=Object(v.a)(f,(function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticClass:"m-6"},[l("file-upload",{ref:"upload",attrs:{multiple:!0,"custom-action":e.uploadFiles},on:{"input-file":e.inputFile,"input-filter":e.inputFilter},model:{value:e.files,callback:function(t){e.files=t},expression:"files"}},[e.files.length?e._e():l("btn",{attrs:{type:"primary",label:e.$t("assets.upload")}})],1),e._v(" "),l("div",{staticClass:"flex flex-wrap"},[e.files.length>=2?l("div",{staticClass:"mr-4 my-4 w-56"},[l("input-text",{attrs:{small:"",placeholder:e.$t("assets.form.title")},on:{input:function(t){return e.handleFillEverything(t,"title_"+e.$i18n.locale)}}}),e._v(" "),l("input-text",{attrs:{small:"",placeholder:e.$t("assets.form.place")},on:{input:function(t){return e.handleFillEverything(t,"place_"+e.$i18n.locale)}}}),e._v(" "),l("Select",{attrs:{placeholder:e.$t("assets.form.travel"),options:e.travels,"option-label":"travel_title_"+e.$i18n.locale},on:{input:function(t){return e.handleFillEverything(t,"travel_id")}}}),e._v(" "),l("input-text",{attrs:{small:"",placeholder:e.$t("assets.form.country")},on:{input:function(t){return e.handleFillEverything(t,"country_"+e.$i18n.locale)}}}),e._v(" "),l("input-text",{attrs:{small:"",placeholder:e.$t("assets.form.description")},on:{input:function(t){return e.handleFillEverything(t,"desc_"+e.$i18n.locale)}}})],1):e._e(),e._v(" "),e._l(e.files,(function(t,i){return l("div",{key:i,staticClass:"mr-4 my-4 w-56"},[l("input-text",{attrs:{small:"",placeholder:e.$t("assets.form.title")},model:{value:e.filesData[i]["title_"+e.$i18n.locale],callback:function(t){e.$set(e.filesData[i],"title_"+e.$i18n.locale,t)},expression:"filesData[i][`title_${$i18n.locale}`]"}}),e._v(" "),l("input-text",{attrs:{small:"",placeholder:e.$t("assets.form.place")},model:{value:e.filesData[i]["place_"+e.$i18n.locale],callback:function(t){e.$set(e.filesData[i],"place_"+e.$i18n.locale,t)},expression:"filesData[i][`place_${$i18n.locale}`]"}}),e._v(" "),l("Select",{attrs:{placeholder:e.$t("assets.form.travel"),options:e.travels,"option-label":"travel_title_"+e.$i18n.locale},model:{value:e.filesData[i].travel_id,callback:function(t){e.$set(e.filesData[i],"travel_id",t)},expression:"filesData[i].travel_id"}}),e._v(" "),l("input-text",{attrs:{small:"",placeholder:e.$t("assets.form.country")},model:{value:e.filesData[i]["country_"+e.$i18n.locale],callback:function(t){e.$set(e.filesData[i],"country_"+e.$i18n.locale,t)},expression:"filesData[i][`country_${$i18n.locale}`]"}}),e._v(" "),l("input-text",{attrs:{small:"",placeholder:e.$t("assets.form.description")},model:{value:e.filesData[i]["desc_"+e.$i18n.locale],callback:function(t){e.$set(e.filesData[i],"desc_"+e.$i18n.locale,t)},expression:"filesData[i][`desc_${$i18n.locale}`]"}}),e._v(" "),l("img",{staticClass:"w-56",attrs:{src:t.blob}}),e._v(" "),l("p",{staticClass:"text-sm"},[e._v("\n        "+e._s(t.name)+"\n      ")])],1)}))],2),e._v(" "),l("btn",{directives:[{name:"show",rawName:"v-show",value:e.files.length&&(!e.$refs.upload||!e.$refs.upload.active),expression:"files.length && (!$refs.upload || !$refs.upload.active)"}],attrs:{type:"primary",label:e.$t("assets.do_upload")},on:{click:e.handleUpload}}),e._v(" "),e.loading?l("Loader"):e._e()],1)}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{Btn:l(287).default,InputText:l(290).default,Select:l(295).default,Loader:l(341).default})},366:function(e,t,l){"use strict";l.r(t);l(27),l(17),l(18);var r=l(286),n=l(332),c={components:{draggable:l.n(n).a},props:{assets:r.a.array.def([]),travels:r.a.array.def([]),articles:r.a.array.def([])},data:function(){var e=this.$i18n.locale;return{locale:e,otherLocale:"fr"===e?"it":"fr",mounted:!1,assetsByTravel:{},filteredAssets:[],modifiedAssetsIds:{}}},mounted:function(){var e=this;this.locale=this.$i18n.locale,this.travels.forEach((function(t){e.$set(e.assetsByTravel,t.travel_id,e.assets.filter((function(e){return e.asset_travel_id===t.travel_id})))})),this.filteredAssets=this.assets.filter((function(e){return!e.asset_travel_id})),this.mounted=!0},methods:{handleAssetChange:function(e,t){if(e.added){var l=e.added.element;this.modifiedAssetsIds[l.asset_id]={past:l.asset_travel_id,present:t}}},getModifiedAssets:function(){return this.modifiedAssetsIds}}},o=l(24),component=Object(o.a)(c,(function(){var e=this,t=e.$createElement,l=e._self._c||t;return e.mounted?l("div",{staticClass:"flex"},[l("div",{staticClass:"assets-list w-1/3 p-4"},[l("h3",[e._v(e._s(e.$t("assets.non_associated")))]),e._v(" "),l("draggable",{class:{"flex flex-wrap py-8":!!e.filteredAssets.length},attrs:{list:e.filteredAssets,group:{name:"assets",pull:!0,put:!0}},on:{change:e.handleAssetChange}},e._l(e.filteredAssets,(function(e){return l("div",{key:"asset-"+e.asset_id,staticClass:"draggable-asset__container mr-2 mb-2"},[l("img",{staticClass:"w-24",attrs:{src:e.asset_src}})])})),0),e._v(" "),e.filteredAssets.length?e._e():l("div",{staticClass:"my-4 text-xs"},[e._v(e._s(e.$t("assets.non_associated_empty")))])],1),e._v(" "),l("div",{staticClass:"travels-list w-2/3 bg-gray-200 p-4 h-3/4 overflow-y-scroll"},e._l(e.travels,(function(t){return l("div",{key:"travel-"+t.travel_id},[l("h3",{class:t["travel_title_"+e.locale]?"":"italic text-gray-500"},[e._v("\n        "+e._s(t["travel_title_"+e.locale]?t["travel_title_"+e.locale]:t["travel_title_"+e.otherLocale])+"\n      ")]),e._v(" "),l("draggable",{class:{"flex flex-wrap py-4":!!e.assetsByTravel[t.travel_id].length},attrs:{list:e.assetsByTravel[t.travel_id],group:{name:"assets",pull:!0,put:!0}},on:{change:function(l){return e.handleAssetChange(l,t.travel_id)}}},e._l(e.assetsByTravel[t.travel_id],(function(e){return l("div",{key:"asset-travel-"+e.asset_id},[l("img",{staticClass:"w-24 mr-2 mb-2",attrs:{src:e.asset_src}})])})),0),e._v(" "),e.assetsByTravel[t.travel_id].length?e._e():l("div",{staticClass:"my-4 text-xs"},[e._v(e._s(e.$t("assets.travel_empty")))])],1)})),0)]):e._e()}),[],!1,null,null,null);t.default=component.exports},367:function(e,t,l){"use strict";l.r(t);l(62),l(27),l(17),l(39),l(48),l(16),l(197),l(56),l(38),l(18),l(40);var r=l(135),n=l(286),c=l(332),o={components:{draggable:l.n(c).a},props:{assets:n.a.array.def([]),travels:n.a.array.def([]),articles:n.a.array.def([])},data:function(){var e=this.$i18n.locale;return{locale:e,otherLocale:"fr"===e?"it":"fr",mounted:!1,assetsByArticle:{},modifiedAssetsIds:{}}},mounted:function(){var e=this;this.locale=this.$i18n.locale,this.articles.forEach((function(article){e.$set(e.assetsByArticle,article.article_id,e.assets.filter((function(e){return e.asset_article_ids.includes(article.article_id)})))})),this.mounted=!0},methods:{handleAssetChange:function(e,t){if(e.added){var l=e.added.element,n=!!this.modifiedAssetsIds[l.asset_id]?[].concat(Object(r.a)(l.asset_article_ids),Object(r.a)(this.modifiedAssetsIds[l.asset_id].present)):Object(r.a)(l.asset_article_ids);this.modifiedAssetsIds[l.asset_id]={past:l.asset_article_ids,present:Array.from(new Set([].concat(Object(r.a)(n),[t])))}}},removeAssetFromArticle:function(e,t){var l=!!this.modifiedAssetsIds[e.asset_id];this.modifiedAssetsIds[e.asset_id]={past:e.asset_article_ids,present:l?this.modifiedAssetsIds[e.asset_id].present.filter((function(a){return a!==e.asset_id})):e.asset_article_ids.filter((function(a){return a!==t}))},this.assetsByArticle[t]=this.assetsByArticle[t].filter((function(a){return a.asset_id!==e.asset_id}))},getModifiedAssets:function(){return this.modifiedAssetsIds}}},d=l(24),component=Object(d.a)(o,(function(){var e=this,t=e.$createElement,l=e._self._c||t;return e.mounted?l("div",{staticClass:"flex"},[l("div",{staticClass:"assets-list w-1/3 p-4 h-3/4 overflow-y-scroll"},[l("h3",[e._v(e._s(e.$t("assets.non_associated")))]),e._v(" "),l("draggable",{class:{"flex flex-wrap py-8":!!e.assets.length},attrs:{list:e.assets,group:{name:"assets",pull:"clone",put:!1}},on:{change:e.handleAssetChange}},e._l(e.assets,(function(e){return l("div",{key:"asset-"+e.asset_id,staticClass:"draggable-asset__container mr-2 mb-2"},[l("img",{staticClass:"w-24",attrs:{src:e.asset_src}})])})),0)],1),e._v(" "),l("div",{staticClass:"articles-list w-2/3 bg-gray-200 p-4 h-3/4 overflow-y-scroll"},e._l(e.articles,(function(article){return l("div",{key:"article-"+article.article_id},[l("h3",{class:article["article_title_"+e.locale]?"":"italic text-gray-500"},[e._v("\n        "+e._s(article["article_title_"+e.locale]?article["article_title_"+e.locale]:article["article_title_"+e.otherLocale])+"\n      ")]),e._v(" "),l("draggable",{class:{"flex flex-wrap py-4":!!e.assetsByArticle[article.article_id].length},attrs:{list:e.assetsByArticle[article.article_id],group:{name:"assets",pull:!1,put:!0}},on:{change:function(t){return e.handleAssetChange(t,article.article_id)}}},e._l(e.assetsByArticle[article.article_id],(function(t){return l("div",{key:"asset-article-"+t.asset_id,staticClass:"relative"},[l("span",{staticClass:"absolute top-0 right-0 my-2 mr-4 text-white",on:{click:function(l){return e.removeAssetFromArticle(t,article.article_id)}}},[l("Icon",{attrs:{name:"cross",small:""}})],1),e._v(" "),l("img",{staticClass:"w-24 mr-2 mb-2",attrs:{src:t.asset_src}})])})),0),e._v(" "),e.assetsByArticle[article.article_id].length?e._e():l("div",{staticClass:"my-4 text-xs"},[e._v("\n        "+e._s(e.$t("assets.article_empty"))+"\n      ")])],1)})),0)]):e._e()}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{Icon:l(288).default})},377:function(e,t,l){"use strict";l.r(t);l(19),l(27),l(82),l(17),l(191),l(36),l(37),l(28),l(16),l(38),l(18),l(40);var r=l(9),n=l(15),c=(l(32),l(4));function o(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(object);e&&(l=l.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,l)}return t}function d(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?o(Object(source),!0).forEach((function(t){Object(r.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):o(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var f={asyncData:function(e){return Object(c.a)(regeneratorRuntime.mark((function t(){var l,r,c,o,d,f,v,_,m;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return l=e.$axios,r=[],c=[],o=[],t.prev=4,t.next=7,Promise.all([l.get("/api/assets"),l.get("/api/travels"),l.get("/api/articles")]);case 7:d=t.sent,f=Object(n.a)(d,3),v=f[0],_=f[1],m=f[2],r=v.data,c=_.data,o=m.data,t.next=20;break;case 17:t.prev=17,t.t0=t.catch(4),console.log(t.t0);case 20:return t.abrupt("return",{assets:r,travels:c,articles:o});case 21:case"end":return t.stop()}}),t,null,[[4,17]])})))()},data:function(){return{activeTab:"library",tabs:[{key:"library",name:this.$t("assets.library")},{key:"travel-assets",name:this.$t("assets.travel_assets")},{key:"article-assets",name:this.$t("assets.article_assets")}]}},methods:{reloadAssets:function(){var e=this;return Object(c.a)(regeneratorRuntime.mark((function t(){var l,data;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$axios.get("/api/assets");case 2:l=t.sent,data=l.data,e.assets=data;case 5:case"end":return t.stop()}}),t)})))()},saveAssociatedAssets:function(){var e=this,t="travel-assets"===this.activeTab?"travel":"article";try{var l={};"travel"===t&&(l=this.$refs.travelAssets.getModifiedAssets()),"article"===t&&(l=this.$refs.articleAssets.getModifiedAssets()),Object.keys(l).forEach(function(){var r=Object(c.a)(regeneratorRuntime.mark((function r(n){var c,o;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(l[n].past===l[n].present){r.next=11;break}return r.prev=1,c=e.assets.find((function(a){return a.asset_id===Number(n)})),o=d(d({},c),{},{asset_article_ids:"travel"===t?JSON.stringify(c.asset_article_ids):JSON.stringify(l[n].present),asset_travel_id:"travel"===t?l[n].present:c.asset_travel_id}),r.next=6,e.$axios.put("/api/assets/".concat(n),o);case 6:r.next=11;break;case 8:r.prev=8,r.t0=r.catch(1),console.warn(r.t0);case 11:case"end":return r.stop()}}),r,null,[[1,8]])})));return function(e){return r.apply(this,arguments)}}()),this.$toast.success(this.$t("assets.updated_success")),this.reloadAssets()}catch(e){console.warn(e),this.$toast.error(this.$t("assets.updated_error"))}}}},v=l(24),component=Object(v.a)(f,(function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",[l("div",{staticClass:"flex justify-between"},[l("Tabs",{attrs:{tabs:e.tabs},on:{tab:function(t){e.activeTab=t.key}}}),e._v(" "),l("div",{staticClass:"self-center mr-4"},["library"!==e.activeTab?l("Btn",{attrs:{"icon-btn":"",icon:"floppy-disk"},on:{click:e.saveAssociatedAssets}}):e._e()],1)],1),e._v(" "),"library"===e.activeTab?l("div",[l("AssetPickerUploader",{attrs:{travels:e.travels},on:{uploaded:e.reloadAssets}}),e._v(" "),l("AssetPickerLibrary",{attrs:{assets:e.assets,data:{travels:e.travels,articles:e.articles}},on:{change:e.reloadAssets}})],1):"travel-assets"===e.activeTab?l("div",[l("DraggableTravelAssets",{ref:"travelAssets",attrs:{assets:e.assets,travels:e.travels,articles:e.articles}}),e._v(" "),l("div",{staticClass:"w-full flex justify-end"},[l("Btn",{staticClass:"m-4",attrs:{"icon-btn":"",icon:"floppy-disk"},on:{click:e.saveAssociatedAssets}})],1)],1):"article-assets"===e.activeTab?l("div",[l("DraggableArticleAssets",{ref:"articleAssets",attrs:{assets:e.assets,travels:e.travels,articles:e.articles}}),e._v(" "),l("div",{staticClass:"w-full flex justify-end"},[l("Btn",{staticClass:"m-4",attrs:{"icon-btn":"",icon:"floppy-disk"},on:{click:e.saveAssociatedAssets}})],1)],1):e._e()])}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{Tabs:l(364).default,Btn:l(287).default,AssetPickerUploader:l(365).default,AssetPickerLibrary:l(325).default,DraggableTravelAssets:l(366).default,DraggableArticleAssets:l(367).default})}}]);