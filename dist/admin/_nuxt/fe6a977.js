(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{284:function(e,t,r){"use strict";r.r(t);r(60);var l=r(283),n={props:{type:l.a.string.def("primary"),label:l.a.string.def("Save"),iconBtn:l.a.bool.def(!1),icon:l.a.string.def("checkmark"),additionalClasses:l.a.string.def("")},computed:{classes:function(){var e=this.iconBtn?"px-4 py-2":"p-2";return"bg-".concat(this.type||"primary"," ").concat("raw"===this.type?"":"border text-white"," ").concat(e)}}},c=r(23),component=Object(c.a)(n,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("button",{class:[e.classes,e.additionalClasses,"rounded text-center"],attrs:{type:"button"},on:{click:function(t){return e.$emit("click")}}},[e.iconBtn?r("span",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.label,expression:"label"}]},[r("Icon",{attrs:{name:e.icon}})],1):r("span",[e._v(e._s(e.label))])])}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{Icon:r(286).default})},286:function(e,t,r){"use strict";r.r(t);var l=r(283),n={props:{name:l.a.string.def(""),small:l.a.bool.def(!1)}},c=r(23),component=Object(c.a)(n,(function(){var e=this.$createElement,t=this._self._c||e;return t("svg",this._g({class:{"fill-current icon":!0,"cursor-pointer":!!this.$listeners,"w-2 h-2":this.small,"w-4 h-4":!this.small}},this.$listeners),[t("use",{attrs:{"xlink:href":"#icon-"+this.name}})])}),[],!1,null,null,null);t.default=component.exports},288:function(e,t,r){"use strict";r.r(t);var l=r(283),n={props:{type:l.a.string.def("text"),name:l.a.string.def("input"),id:l.a.string.def("input"),label:l.a.string.def(""),placeholder:l.a.string.def(""),required:l.a.bool.def(!1),disabled:l.a.bool.def(!1),value:l.a.string.def(""),small:l.a.bool.def(!1)}},c=r(23),component=Object(c.a)(n,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{class:{"mt-2 mb-4":!e.small}},[e.label?r("h4",{staticClass:"label font-bold my-4"},[r("span",{staticClass:"bg-white z-10 pr-6"},[e._v(e._s(e.label))])]):e._e(),e._v(" "),r("input",{class:[e.small?"text-xs":"","w-full p-2 rounded border"],attrs:{id:e.id,type:e.type,name:e.name,required:e.required,disabled:e.disabled,placeholder:e.placeholder},domProps:{value:e.value},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.$emit("enter")},input:function(t){return e.$emit("input",t.target.value)}}})])}),[],!1,null,null,null);t.default=component.exports},290:function(e,t,r){"use strict";r.r(t);var l={},n=r(23),component=Object(n.a)(l,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("portal",{attrs:{to:"modal"}},[r("div",{staticClass:"flex flex-col justify-center items-center m-16"},[r("h4",{staticClass:"font-bold text-lg text-center mb-4"},[e._v(e._s(e.$t("general.sure")))]),e._v(" "),r("div",{staticClass:"flex justify-center"},[r("Btn",{attrs:{label:e.$t("general.confirm"),"additional-classes":"mr-4"},on:{click:function(t){return e.$emit("confirm")}}}),e._v(" "),r("Btn",{attrs:{label:e.$t("general.cancel"),type:"secondary"},on:{click:function(t){return e.$emit("cancel")}}})],1)])])}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{Btn:r(284).default})},291:function(e,t,r){"use strict";r.r(t);var l=r(302),n=r.n(l),c=r(283),o=(r(303),{components:{vSelect:n.a},props:{label:c.a.string.def(null),placeholder:c.a.string.def(null),options:c.a.array.def([]),optionLabel:c.a.string.def("label"),multiple:c.a.bool.def(!1),taggable:c.a.bool.def(!1),pushTags:c.a.bool.def(!1),value:c.a.oneOfType([c.a.object,c.a.array]).def(null),small:c.a.bool.def(!1)}}),d=(r(305),r(23)),component=Object(d.a)(o,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[e.label?r("h4",{staticClass:"label font-bold my-4"},[r("span",{staticClass:"bg-white z-10 pr-6"},[e._v(e._s(e.label))])]):e._e(),e._v(" "),r("v-select",{attrs:{options:e.options,label:e.optionLabel,multiple:e.multiple,taggable:e.taggable,"push-tags":e.pushTags,placeholder:e.placeholder,value:e.value},on:{input:function(t){return e.$emit("input",t)}}})],1)}),[],!1,null,null,null);t.default=component.exports},292:function(e,t,r){var content=r(306);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(81).default)("2bea4cae",content,!0,{sourceMap:!1})},293:function(e,t,r){var content=r(308);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(81).default)("f280b1c0",content,!0,{sourceMap:!1})},294:function(e,t,r){var content=r(310);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(81).default)("fba0ba2a",content,!0,{sourceMap:!1})},296:function(e,t,r){"use strict";r.r(t);var l=r(283),n={props:{name:l.a.string.def("textarea"),placeholder:l.a.string.def(""),label:l.a.string.def(null),required:l.a.bool.def(!1),rows:l.a.number.def(4),value:l.a.string.def(""),classes:l.a.string.def("")}},c=r(23),component=Object(c.a)(n,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[e.label?r("h4",{staticClass:"label font-bold my-4"},[r("span",{staticClass:"bg-white z-10 pr-6"},[e._v(e._s(e.label))])]):e._e(),e._v(" "),r("textarea",{class:[e.classes,"w-full p-2 rounded border border-grey-600"],attrs:{name:e.name,placeholder:e.placeholder,required:e.required,rows:e.rows},domProps:{value:e.value},on:{input:function(t){return e.$emit("input",t.target.value)}}})])}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{Textarea:r(296).default})},300:function(e,t,r){"use strict";r.r(t);r(60);var l=r(283),n={props:{deletable:l.a.bool.def(!1),selectable:l.a.bool.def(!1),selected:l.a.bool.def(!1),tag:l.a.string.def("")},computed:{color:function(){var e=["gray","indigo","red","orange","yellow","green","teal","blue","purple","pink"];return"".concat(this.selectable&&!this.selected?"border-2 border-":"text-white bg-").concat(e[Math.floor(Math.random()*(e.length-1))],"-500")}}},c=r(23),component=Object(c.a)(n,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{class:[e.color,"text-xs rounded-md px-2 py-1",{"cursor-pointer":e.selectable}],on:{click:function(t){return e.$emit("click")}}},[r("span",[e._v(e._s(e.tag?"#"+e.tag:"# No place"))]),e._v(" "),e.deletable?r("span",{staticClass:"cursor-pointer font-bold",on:{click:function(t){return e.$emit("remove",e.tag)}}},[e._v("x")]):e._e()])}),[],!1,null,null,null);t.default=component.exports},305:function(e,t,r){"use strict";var l=r(292);r.n(l).a},306:function(e,t,r){(t=r(80)(!1)).push([e.i,'.vs__dropdown-toggle{border-width:1px}.label{position:relative;overflow:hidden;display:flex;align-items:center}.label:after{content:"";position:absolute;padding-left:2px;width:100%;height:1px;background-color:#000}',""]),e.exports=t},307:function(e,t,r){"use strict";var l=r(293);r.n(l).a},308:function(e,t,r){(t=r(80)(!1)).push([e.i,".loader{border:16px solid #f3f3f3;border-top-color:#3498db;border-radius:50%;width:120px;height:120px;-webkit-animation:spin 2s linear infinite;animation:spin 2s linear infinite}",""]),e.exports=t},309:function(e,t,r){"use strict";var l=r(294);r.n(l).a},310:function(e,t,r){(t=r(80)(!1)).push([e.i,".backdrop,.backdrop-content{transition:opacity .3s}.backdrop-container:hover>.backdrop,.backdrop-container:hover>.backdrop-content{opacity:1}.backdrop-container:hover>.backdrop{filter:blur(5px) grayscale(.7)}",""]),e.exports=t},321:function(e,t,r){"use strict";r.r(t);var l={},n=(r(307),r(23)),component=Object(n.a)(l,(function(){var e=this.$createElement;this._self._c;return this._m(0)}),[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"w-screen h-screen fixed bg-gray-200 inset-0 flex justify-center items-center z-50"},[t("div",{staticClass:"loader animation-spin"})])}],!1,null,null,null);t.default=component.exports},322:function(e,t,r){"use strict";r.r(t);r(19),r(40),r(30),r(17),r(48),r(53),r(190),r(46),r(47),r(31),r(38),r(56),r(61),r(62),r(18),r(32);var l=r(4),n=r(12),c=r(366),o=r(283),d=r(26);function f(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}function v(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?f(Object(source),!0).forEach((function(t){Object(n.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):f(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var m={props:{assets:o.a.array.def([]),pick:o.a.string.def(null),picked:o.a.oneOfType([o.a.array,o.a.object]).def(null),data:o.a.object.def({}),pickLimit:o.a.number.def(null)},data:function(){return{locale:"",pickedAsset:null,pickedAssetsIds:[],assetToRemove:null,assetToEdit:null,filters:{travel:null,place:null}}},computed:v(v({},Object(d.c)("modal",["modalId"])),{},{places:function(){var e=this;return this.data.articles.map((function(article){var t=article["article_place_".concat(e.locale)];if(t)return{key:t.toLowerCase().replaceAll(" ","_"),label:t}})).filter((function(e){return!!e}))},filteredAssets:function(){var e=this;return this.assets.filter((function(t){return e.filters.travel&&e.filters.place?e.filters.travel===Number(t.asset_travel_id)&&!!t["asset_place_".concat(e.locale)]&&e.filters.place===t["asset_place_".concat(e.locale)]:!e.filters.travel&&!e.filters.place||(e.filters.travel===Number(t.asset_travel_id)||e.filters.place===t["asset_place_".concat(e.locale)])}))}}),mounted:function(){var e=this;this.locale=this.$i18n.locale,this.picked&&("multiple"===this.pick?this.pickedAssetsIds=this.picked.map((function(p){return p.asset_id})):(this.pickedAsset=this.picked,this.$nextTick((function(){e.initWithPicked()}))))},methods:v(v({},Object(d.b)("modal",["setVisible","setModalId"])),{},{getUploadDate:function(e){var t=e.split("_")[0];return Object(c.a)(new Date(Number(t)),"dd/MM/yyyy")},initWithPicked:function(){var e=this;this.$refs.asset.forEach((function(a){Number(a.getAttribute("id"))!==Number(e.pickedAsset.asset_id)?a.classList.add("opacity-50"):a.classList.remove("opacity-50")}))},handlePickOneAsset:function(e){var t=this;this.$refs.asset.forEach((function(a){t.pickedAsset&&t.pickedAsset.asset_id===e.asset_id?a.classList.remove("opacity-50"):Number(a.getAttribute("id"))!==Number(e.asset_id)?a.classList.add("opacity-50"):a.classList.remove("opacity-50")})),this.pickedAsset=e},handleAssetPick:function(e,t){var r,l=this;(t.stopPropagation(),t.preventDefault(),"one"===this.pick&&(this.handlePickOneAsset(e),this.$emit("pick",e)),"multiple"===this.pick)&&((!this.pickLimit||this.pickedAssetsIds.length<this.pickLimit||this.pickedAssetsIds.length===this.pickLimit&&!t.target.checked)&&(t.target.checked?(r="add",this.pickedAssetsIds.push(e.asset_id)):(r="remove",this.pickedAssetsIds=this.pickedAssetsIds.filter((function(a){return a!==e.asset_id}))),this.pickedAssetsIds.length===this.pickLimit?this.$refs.assetContainer.forEach((function(a){l.pickedAssetsIds.includes(Number(a.getAttribute("id").replace("container_","")))||(a.classList.add("pointer-events-none"),a.classList.add("opacity-50"))})):this.$refs.assetContainer.forEach((function(a){a.classList.remove("pointer-events-none"),a.classList.remove("opacity-50")})),this.$emit("picks",this.pickedAssetsIds,e,r)))},handleEdit:function(e){this.assetToEdit=e,this.setVisible(!0),this.setModalId("asset-edit")},handleRemove:function(e){this.assetToRemove=e,this.setVisible(!0),this.setModalId("asset-remove")},removeAsset:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$axios.post("/api/assets/delete",{ids:[e.assetToRemove.asset_id],names:[e.assetToRemove.asset_name]});case 3:e.$toast.success(e.$t("assets.removed_success")),e.$emit("change"),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0),e.$toast.error(e.$t("assets.removed_error"));case 11:return t.prev=11,e.closeRemoveModal(),e.assetToRemove=null,t.finish(11);case 15:case"end":return t.stop()}}),t,null,[[0,7,11,15]])})))()},updateAsset:function(e,t){var r=this;return Object(l.a)(regeneratorRuntime.mark((function l(){var c,o;return regeneratorRuntime.wrap((function(l){for(;;)switch(l.prev=l.next){case 0:return o=v(v({},t),{},(c={},Object(n.a)(c,"asset_desc_".concat(r.locale),e.description),Object(n.a)(c,"asset_title_".concat(r.locale),e.title),Object(n.a)(c,"asset_article_ids",JSON.stringify(e.article_ids.map((function(e){return Number(e.article_id)})))),Object(n.a)(c,"asset_travel_id",Number(e.travel.travel_id)),c)),l.prev=1,l.next=4,r.$axios.put("/api/assets/".concat(t.asset_id),o);case 4:r.$toast.success(r.$t("assets.updated_success")),r.$emit("change"),r.assetToEdit=null,l.next=13;break;case 9:l.prev=9,l.t0=l.catch(1),console.log(l.t0),r.$toast.error(r.$t("assets.updated_error"));case 13:case"end":return l.stop()}}),l,null,[[1,9]])})))()},closeRemoveModal:function(){this.setVisible(!1),this.setModalId(null)},handleFilter:function(e){e.travel_id?this.filters.travel=this.filters.travel===e.travel_id?null:e.travel_id:this.filters.place=this.filters.place===e.label?null:e.label}})},_=(r(309),r(23)),component=Object(_.a)(m,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("section",[r("div",{staticClass:"m-6"},[r("div",{staticClass:"flex my-4"},[r("div",{staticClass:"w-1/2 flex flex-col items-center"},[r("h4",[e._v(e._s(e.$t("assets.filter_by_travel")))]),e._v(" "),r("div",{staticClass:"flex flex-wrap justify-center w-full"},e._l(e.data.travels,(function(t){return r("Tag",{key:t.travel_id,staticClass:"mr-2 my-2",attrs:{tag:t["travel_title_"+e.locale],selectable:"",selected:e.filters.travel===t.travel_id},on:{click:function(r){return e.handleFilter(t)}}})})),1)]),e._v(" "),r("div",{staticClass:"w-1/2 flex flex-col items-center"},[r("h4",[e._v(e._s(e.$t("assets.filter_by_place")))]),e._v(" "),r("div",{staticClass:"flex flex-wrap justify-center w-full"},e._l(e.places,(function(t){return r("Tag",{key:t.key,staticClass:"mr-2 my-2",attrs:{tag:t.label,selectable:"",selected:e.filters.place===t.label},on:{click:function(r){return e.handleFilter(t)}}})})),1)])]),e._v(" "),r("div",{staticClass:"flex flex-wrap justify-center"},[e._l(e.filteredAssets,(function(t,i){return r("div",{key:i,ref:"assetContainer",refInFor:!0,class:{"w-64 mr-4 my-2 relative":!0,"h-72 border border-grey-100":!e.pick},attrs:{id:"container_"+t.asset_id}},["multiple"===e.pick?r("span",{staticClass:"absolute top-0 right-0"},[r("input",{staticClass:"mr-2 mt-2 z-20",attrs:{type:"checkbox"},domProps:{checked:e.pickedAssetsIds.includes(t.asset_id)},on:{change:function(r){return e.handleAssetPick(t,r)}}})]):e._e(),e._v(" "),r("div",{class:{"backdrop-container max-h-2/3 overflow-hidden relative flex justify-center items-center":!e.pick}},[e.pick?e._e():r("div",{staticClass:"backdrop opacity-0 absolute inset-0 h-full w-full hover:opacity-100 transition-opacity duration-300 bg-blue-100 bg-opacity-50"}),e._v(" "),e.pick?e._e():r("div",{staticClass:"backdrop-content z-10 flex absolute inset-0 justify-center items-center opacity-0"},[r("Btn",{attrs:{"icon-btn":"",icon:"pencil"},on:{click:function(r){return e.handleEdit(t)}}}),e._v(" "),r("Btn",{attrs:{"icon-btn":"",type:"secondary",icon:"bin"},on:{click:function(r){return e.handleRemove(t)}}})],1),e._v(" "),r("img",{ref:"asset",refInFor:!0,class:{"max-h-2/3":!e.pick,"cursor-pointer":e.pick,"w-full overflow-hidden":!0},attrs:{id:t.asset_id,src:t.asset_src},on:{click:function(r){return e.handleAssetPick(t,r)}}})]),e._v(" "),e.pick?e._e():r("div",{staticClass:"asset__infos p-4"},[t["asset_title_"+e.$i18n.locale]?r("p",{staticClass:"font-bold text-lg"},[e._v("\n            "+e._s(t["asset_title_"+e.$i18n.locale])+"\n          ")]):e._e(),e._v(" "),r("p",{staticClass:"text-sm text-gray-600"},[e._v("\n            "+e._s(e.$t("assets.uploaded"))+"\n            "+e._s(e.getUploadDate(t.asset_name))+"\n          ")]),e._v(" "),t["asset_desc_"+e.$i18n.locale]?r("p",{staticClass:"text-sm text-gray-600"},[e._v("\n            "+e._s(e.$t("assets.description"))+"\n            "+e._s(t["asset_desc_"+e.$i18n.locale])+"\n          ")]):e._e()])])})),e._v(" "),e.filteredAssets.length?e._e():r("div",{staticClass:"flex justify-center max-w-1/4 my-16"},[e._v("\n        "+e._s(e.$t("assets.filtered_empty"))+"\n      ")])],2),e._v(" "),"asset-remove"===e.modalId?r("RemoveModal",{on:{confirm:e.removeAsset,cancel:e.closeRemoveModal}}):e._e(),e._v(" "),"asset-edit"===e.modalId?r("EditAssetModal",{attrs:{travels:e.data.travels,articles:e.data.articles,image:e.assetToEdit},on:{confirm:e.updateAsset,cancel:e.closeRemoveModal}}):e._e()],1)])}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{Tag:r(300).default,Btn:r(284).default,RemoveModal:r(290).default,EditAssetModal:r(323).default})},323:function(e,t,r){"use strict";r.r(t);r(19),r(30),r(82),r(17),r(48),r(46),r(47),r(31),r(56),r(18);var l=r(12),n=r(283),c=r(26);function o(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}function d(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?o(Object(source),!0).forEach((function(t){Object(l.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):o(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var f={props:{image:n.a.object.def(null),articles:n.a.array.def([]),travels:n.a.array.def([])},data:function(){return{locale:"",model:{name:"",title:"",description:"",article_ids:[],travel:null}}},mounted:function(){var e=this.$i18n.locale;this.locale=e;var t=this.image,r=t.asset_name,l=t.asset_article_ids,n=t.asset_travel_id;this.model={name:r,title:this.image["asset_title_".concat(e)],description:this.image["asset_desc_".concat(e)],article_ids:l?this.articles.filter((function(article){return l.includes(article.article_id)})):[],travel:n?this.travels.find((function(e){return e.travel_id===n})):null}},methods:d(d({},Object(c.b)("modal",["setVisible","setModalId"])),{},{handleConfirm:function(){this.$emit("confirm",this.model,this.image),this.closeModal()},handleCancel:function(){this.closeModal()},closeModal:function(){this.setModalId(null),this.setVisible(!1)},handleReduce:function(option){return option["article_title_".concat(this.locale)]}})},v=r(23),component=Object(v.a)(f,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("portal",{attrs:{to:"modal"}},[r("div",[r("div",{staticClass:"h-full flex"},[r("div",{staticClass:"m-8"},[r("img",{staticClass:"h-48",attrs:{src:e.image.asset_src}})]),e._v(" "),r("div",{staticClass:"mr-8 mb-8 max-w-1/2"},[r("InputText",{attrs:{label:e.$t("assets.edit.name"),disabled:""},model:{value:e.model.name,callback:function(t){e.$set(e.model,"name",t)},expression:"model.name"}}),e._v(" "),r("InputText",{attrs:{label:e.$t("assets.edit.title")},model:{value:e.model.title,callback:function(t){e.$set(e.model,"title",t)},expression:"model.title"}}),e._v(" "),r("Textarea",{attrs:{label:e.$t("assets.edit.description")},model:{value:e.model.description,callback:function(t){e.$set(e.model,"description",t)},expression:"model.description"}}),e._v(" "),r("Select",{attrs:{multiple:"",label:e.$t("assets.edit.articles"),options:e.articles,"option-label":"article_title_"+e.locale},model:{value:e.model.article_ids,callback:function(t){e.$set(e.model,"article_ids",t)},expression:"model.article_ids"}}),e._v(" "),r("Select",{attrs:{label:e.$t("assets.edit.travel"),options:e.travels,"option-label":"travel_title_"+e.locale},model:{value:e.model.travel,callback:function(t){e.$set(e.model,"travel",t)},expression:"model.travel"}})],1)]),e._v(" "),r("div",{staticClass:"sticky bottom-0 w-full translate-x-0 p-2 bg-white border-t-2 border-gray-500"},[r("div",{staticClass:"flex justify-end"},[r("Btn",{attrs:{label:e.$t("general.confirm")},on:{click:e.handleConfirm}}),e._v(" "),r("Btn",{attrs:{label:e.$t("general.cancel"),type:"secondary"},on:{click:e.handleCancel}})],1)])])])}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{InputText:r(288).default,Textarea:r(296).default,Select:r(291).default,Btn:r(284).default})},352:function(e,t,r){"use strict";r.r(t);r(19),r(30),r(17),r(53),r(46),r(47),r(31),r(18);var l=r(12);function n(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}function c(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?n(Object(source),!0).forEach((function(t){Object(l.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):n(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var o={props:{tabs:r(283).a.array.def([])},data:function(){return{mappedTabs:[]}},mounted:function(){this.mappedTabs=this.tabs.map((function(e,i){return c(c({},e),{},{active:0===i})}))},methods:{handleTabClick:function(e){this.$emit("tab",e),this.mappedTabs=this.mappedTabs.map((function(t){return c(c({},t),{},{active:t.key===e.key})}))}}},d=r(23),component=Object(d.a)(o,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"flex m-6"},e._l(e.mappedTabs,(function(t){return r("div",{key:t.key,class:{"font-bold border-b-2 border-gray-400":t.active,"cursor-pointer mr-8 py-2":!0},on:{click:function(r){return e.handleTabClick(t)}}},[e._v("\n    "+e._s(t.name)+"\n  ")])})),0)}),[],!1,null,null,null);t.default=component.exports},353:function(e,t,r){"use strict";r.r(t);r(19),r(60),r(30),r(17),r(20),r(46),r(47),r(31),r(16),r(36),r(18),r(37),r(332),r(32);var l=r(4),n=r(12),c=r(283),o=r(336);function d(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}var f={components:{FileUpload:r.n(o).a},props:{travels:c.a.array.def([])},data:function(){return{loading:!1,files:[],filesData:[]}},methods:{handleUpload:function(){this.$refs.upload.active=!0,this.loading=!0},inputFile:function(e,t){(!t||e&&t.name!==e.name)&&(console.log("PUSH NEW FILE DATA"),this.filesData.push(function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?d(Object(source),!0).forEach((function(t){Object(n.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):d(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}({id:e.id,name:e.name},{title_fr:"",title_it:"",place_fr:"",place_it:"",country_fr:"",country_it:"",desc_fr:"",desc_it:"",travel_id:""}))),e&&t&&!e.active&&t.active&&e.xhr},inputFilter:function(e,t,r){if(e&&!t&&!/\.(jpeg|jpe|jpg|gif|png|webp)$/i.test(e.name))return r();e.blob="";var l=window.URL||window.webkitURL;l&&l.createObjectURL&&(e.blob=l.createObjectURL(e.file))},uploadFiles:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=new FormData,e.files.forEach((function(t,l){r.append("file[".concat(l,"]"),t.file),Object.keys(e.filesData[l]).forEach((function(t,i){r.append("infos[".concat(l,"][").concat(t,"]"),e.filesData[l][t])}))})),t.prev=2,t.next=5,e.$axios.post("/api/assets",r,{headers:{"Content-Type":"multipart/form-data"}});case 5:e.files=[],e.filesData=[],e.$toast.success(e.$t("assets.upload_success")),e.$emit("uploaded"),t.next=15;break;case 11:t.prev=11,t.t0=t.catch(2),console.log("ERROR",t.t0),e.$toast.error(e.$t("assets.upload_error"));case 15:return t.prev=15,e.loading=!1,t.finish(15);case 18:case"end":return t.stop()}}),t,null,[[2,11,15,18]])})))()}}},v=r(23),component=Object(v.a)(f,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"m-6"},[r("file-upload",{ref:"upload",attrs:{multiple:!0,"custom-action":e.uploadFiles},on:{"input-file":e.inputFile,"input-filter":e.inputFilter},model:{value:e.files,callback:function(t){e.files=t},expression:"files"}},[e.files.length?e._e():r("btn",{attrs:{type:"primary",label:e.$t("assets.upload")}})],1),e._v(" "),r("div",{staticClass:"flex flex-wrap"},e._l(e.files,(function(t,i){return r("div",{key:i,staticClass:"mr-4 my-4 w-56"},[r("input-text",{attrs:{small:"",placeholder:e.$t("assets.form.title")},model:{value:e.filesData[i]["title_"+e.$i18n.locale],callback:function(t){e.$set(e.filesData[i],"title_"+e.$i18n.locale,t)},expression:"filesData[i][`title_${$i18n.locale}`]"}}),e._v(" "),r("input-text",{attrs:{small:"",placeholder:e.$t("assets.form.place")},model:{value:e.filesData[i]["place_"+e.$i18n.locale],callback:function(t){e.$set(e.filesData[i],"place_"+e.$i18n.locale,t)},expression:"filesData[i][`place_${$i18n.locale}`]"}}),e._v(" "),r("Select",{attrs:{placeholder:e.$t("assets.form.travel"),options:e.travels,"option-label":"travel_title_"+e.$i18n.locale,"reduce-fn":function(e){return e.travel_id}},model:{value:e.filesData[i].travel_id,callback:function(t){e.$set(e.filesData[i],"travel_id",t)},expression:"filesData[i].travel_id"}}),e._v(" "),r("input-text",{attrs:{small:"",placeholder:e.$t("assets.form.country")},model:{value:e.filesData[i]["countries_"+e.$i18n.locale],callback:function(t){e.$set(e.filesData[i],"countries_"+e.$i18n.locale,t)},expression:"filesData[i][`countries_${$i18n.locale}`]"}}),e._v(" "),r("input-text",{attrs:{small:"",placeholder:e.$t("assets.form.description")},model:{value:e.filesData[i]["desc_"+e.$i18n.locale],callback:function(t){e.$set(e.filesData[i],"desc_"+e.$i18n.locale,t)},expression:"filesData[i][`desc_${$i18n.locale}`]"}}),e._v(" "),r("img",{staticClass:"w-56",attrs:{src:t.blob}}),e._v(" "),r("p",{staticClass:"text-sm"},[e._v("\n        "+e._s(t.name)+"\n      ")])],1)})),0),e._v(" "),r("btn",{directives:[{name:"show",rawName:"v-show",value:e.files.length&&(!e.$refs.upload||!e.$refs.upload.active),expression:"files.length && (!$refs.upload || !$refs.upload.active)"}],attrs:{type:"primary",label:e.$t("assets.do_upload")},on:{click:e.handleUpload}}),e._v(" "),e.loading?r("Loader"):e._e()],1)}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{Btn:r(284).default,InputText:r(288).default,Select:r(291).default,Loader:r(321).default})},354:function(e,t,r){"use strict";r.r(t);r(30),r(17),r(18);var l=r(283),n=r(311),c={components:{draggable:r.n(n).a},props:{assets:l.a.array.def([]),travels:l.a.array.def([]),articles:l.a.array.def([])},data:function(){return{locale:"fr",mounted:!1,assetsByTravel:{},filteredAssets:[],modifiedAssetsIds:{}}},mounted:function(){var e=this;this.locale=this.$i18n.locale,this.travels.forEach((function(t){e.$set(e.assetsByTravel,t.travel_id,e.assets.filter((function(e){return e.asset_travel_id===t.travel_id})))})),this.filteredAssets=this.assets.filter((function(e){return!e.asset_travel_id})),this.mounted=!0},methods:{handleAssetChange:function(e,t){if(e.added){var r=e.added.element;this.modifiedAssetsIds[r.asset_id]={past:r.asset_travel_id,present:t}}},getModifiedAssets:function(){return this.modifiedAssetsIds}}},o=r(23),component=Object(o.a)(c,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.mounted?r("div",{staticClass:"flex"},[r("div",{staticClass:"assets-list w-1/3 p-4"},[r("h3",[e._v(e._s(e.$t("assets.non_associated")))]),e._v(" "),r("draggable",{class:{"flex flex-wrap py-8":!!e.filteredAssets.length},attrs:{list:e.filteredAssets,group:{name:"assets",pull:!0,put:!0}},on:{change:e.handleAssetChange}},e._l(e.filteredAssets,(function(e){return r("div",{key:"asset-"+e.asset_id,staticClass:"draggable-asset__container mr-2 mb-2"},[r("img",{staticClass:"w-24",attrs:{src:e.asset_src}})])})),0),e._v(" "),e.filteredAssets.length?e._e():r("div",{staticClass:"my-4 text-xs"},[e._v(e._s(e.$t("assets.non_associated_empty")))])],1),e._v(" "),r("div",{staticClass:"travels-list w-2/3 bg-gray-200 p-4 h-3/4 overflow-y-scroll"},e._l(e.travels,(function(t){return r("div",{key:"travel-"+t.travel_id},[r("h3",[e._v(e._s(t["travel_title_"+e.locale]))]),e._v(" "),r("draggable",{class:{"flex flex-wrap py-4":!!e.assetsByTravel[t.travel_id].length},attrs:{list:e.assetsByTravel[t.travel_id],group:{name:"assets",pull:!0,put:!0}},on:{change:function(r){return e.handleAssetChange(r,t.travel_id)}}},e._l(e.assetsByTravel[t.travel_id],(function(e){return r("div",{key:"asset-travel-"+e.asset_id},[r("img",{staticClass:"w-24 mr-2 mb-2",attrs:{src:e.asset_src}})])})),0),e._v(" "),e.assetsByTravel[t.travel_id].length?e._e():r("div",{staticClass:"my-4 text-xs"},[e._v(e._s(e.$t("assets.travel_empty")))])],1)})),0)]):e._e()}),[],!1,null,null,null);t.default=component.exports},355:function(e,t,r){"use strict";r.r(t);r(60),r(30),r(17),r(39),r(48),r(16),r(196),r(56),r(36),r(18),r(37);var l=r(135),n=r(283),c=r(311),o={components:{draggable:r.n(c).a},props:{assets:n.a.array.def([]),travels:n.a.array.def([]),articles:n.a.array.def([])},data:function(){return{locale:"fr",mounted:!1,assetsByArticle:{},modifiedAssetsIds:{}}},mounted:function(){var e=this;this.locale=this.$i18n.locale,this.articles.forEach((function(article){e.$set(e.assetsByArticle,article.article_id,e.assets.filter((function(e){return e.asset_article_ids.includes(article.article_id)})))})),this.mounted=!0},methods:{handleAssetChange:function(e,t){if(e.added){var r=e.added.element,n=!!this.modifiedAssetsIds[r.asset_id]?[].concat(Object(l.a)(r.asset_article_ids),Object(l.a)(this.modifiedAssetsIds[r.asset_id].present)):Object(l.a)(r.asset_article_ids);this.modifiedAssetsIds[r.asset_id]={past:r.asset_article_ids,present:Array.from(new Set([].concat(Object(l.a)(n),[t])))}}},removeAssetFromArticle:function(e,t){var r=!!this.modifiedAssetsIds[e.asset_id];this.modifiedAssetsIds[e.asset_id]={past:e.asset_article_ids,present:r?this.modifiedAssetsIds[e.asset_id].present.filter((function(a){return a!==e.asset_id})):e.asset_article_ids.filter((function(a){return a!==t}))},this.assetsByArticle[t]=this.assetsByArticle[t].filter((function(a){return a.asset_id!==e.asset_id}))},getModifiedAssets:function(){return this.modifiedAssetsIds}}},d=r(23),component=Object(d.a)(o,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.mounted?r("div",{staticClass:"flex"},[r("div",{staticClass:"assets-list w-1/3 p-4 h-3/4 overflow-y-scroll"},[r("h3",[e._v(e._s(e.$t("assets.non_associated")))]),e._v(" "),r("draggable",{class:{"flex flex-wrap py-8":!!e.assets.length},attrs:{list:e.assets,group:{name:"assets",pull:"clone",put:!1}},on:{change:e.handleAssetChange}},e._l(e.assets,(function(e){return r("div",{key:"asset-"+e.asset_id,staticClass:"draggable-asset__container mr-2 mb-2"},[r("img",{staticClass:"w-24",attrs:{src:e.asset_src}})])})),0)],1),e._v(" "),r("div",{staticClass:"articles-list w-2/3 bg-gray-200 p-4 h-3/4 overflow-y-scroll"},e._l(e.articles,(function(article){return r("div",{key:"article-"+article.article_id},[r("h3",[e._v(e._s(article["article_title_"+e.locale]))]),e._v(" "),r("draggable",{class:{"flex flex-wrap py-4":!!e.assetsByArticle[article.article_id].length},attrs:{list:e.assetsByArticle[article.article_id],group:{name:"assets",pull:!1,put:!0}},on:{change:function(t){return e.handleAssetChange(t,article.article_id)}}},e._l(e.assetsByArticle[article.article_id],(function(t){return r("div",{key:"asset-article-"+t.asset_id,staticClass:"relative"},[r("span",{staticClass:"absolute top-0 right-0 my-2 mr-4 text-white",on:{click:function(r){return e.removeAssetFromArticle(t,article.article_id)}}},[r("Icon",{attrs:{name:"cross",small:""}})],1),e._v(" "),r("img",{staticClass:"w-24 mr-2 mb-2",attrs:{src:t.asset_src}})])})),0),e._v(" "),e.assetsByArticle[article.article_id].length?e._e():r("div",{staticClass:"my-4 text-xs"},[e._v("\n        "+e._s(e.$t("assets.article_empty"))+"\n      ")])],1)})),0)]):e._e()}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{Icon:r(286).default})},369:function(e,t,r){"use strict";r.r(t);r(19),r(30),r(82),r(17),r(190),r(46),r(47),r(31),r(16),r(36),r(18),r(37);var l=r(12),n=r(15),c=(r(32),r(4));function o(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}function d(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?o(Object(source),!0).forEach((function(t){Object(l.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):o(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var f={asyncData:function(e){return Object(c.a)(regeneratorRuntime.mark((function t(){var r,l,c,o,d,f,v,m,_;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.$axios,l=[],c=[],o=[],t.prev=4,t.next=7,Promise.all([r.get("/api/assets"),r.get("/api/travels"),r.get("/api/articles")]);case 7:d=t.sent,f=Object(n.a)(d,3),v=f[0],m=f[1],_=f[2],l=v.data,c=m.data,o=_.data,t.next=20;break;case 17:t.prev=17,t.t0=t.catch(4),console.log(t.t0);case 20:return t.abrupt("return",{assets:l,travels:c,articles:o});case 21:case"end":return t.stop()}}),t,null,[[4,17]])})))()},data:function(){return{activeTab:"library",tabs:[{key:"library",name:this.$t("assets.library")},{key:"travel-assets",name:this.$t("assets.travel_assets")},{key:"article-assets",name:this.$t("assets.article_assets")}]}},methods:{reloadAssets:function(){var e=this;return Object(c.a)(regeneratorRuntime.mark((function t(){var r,data;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$axios.get("/api/assets");case 2:r=t.sent,data=r.data,e.assets=data;case 5:case"end":return t.stop()}}),t)})))()},saveAssociatedAssets:function(){var e=this,t="travel-assets"===this.activeTabs?"travel":"article";try{var r={};"travel"===t&&(r=this.$refs.travelAssets.getModifiedAssets()),"article"===t&&(r=this.$refs.articleAssets.getModifiedAssets()),Object.keys(r).forEach(function(){var l=Object(c.a)(regeneratorRuntime.mark((function l(n){var c,o;return regeneratorRuntime.wrap((function(l){for(;;)switch(l.prev=l.next){case 0:if(r[n].past===r[n].present){l.next=11;break}return l.prev=1,c=e.assets.find((function(a){return a.asset_id===Number(n)})),o=d(d({},c),{},{asset_article_ids:"travel"===t?JSON.stringify(c.asset_article_ids):JSON.stringify(r[n].present),asset_travel_id:"travel"===t?r[n].present:c.asset_travel_id}),l.next=6,e.$axios.put("/api/assets/".concat(n),o);case 6:l.next=11;break;case 8:l.prev=8,l.t0=l.catch(1),console.warn(l.t0);case 11:case"end":return l.stop()}}),l,null,[[1,8]])})));return function(e){return l.apply(this,arguments)}}()),this.$toast.success(this.$t("assets.updated_success"))}catch(e){this.$toast.success(this.$t("assets.updated_error"))}}}},v=r(23),component=Object(v.a)(f,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticClass:"flex justify-between"},[r("Tabs",{attrs:{tabs:e.tabs},on:{tab:function(t){e.activeTab=t.key}}}),e._v(" "),r("div",{staticClass:"self-center mr-4"},["library"!==e.activeTab?r("Btn",{attrs:{"icon-btn":"",icon:"floppy-disk"},on:{click:e.saveAssociatedAssets}}):e._e()],1)],1),e._v(" "),"library"===e.activeTab?r("div",[r("AssetPickerUploader",{attrs:{travels:e.travels},on:{uploaded:e.reloadAssets}}),e._v(" "),r("AssetPickerLibrary",{attrs:{assets:e.assets,data:{travels:e.travels,articles:e.articles}},on:{change:e.reloadAssets}})],1):"travel-assets"===e.activeTab?r("div",[r("DraggableTravelAssets",{ref:"travelAssets",attrs:{assets:e.assets,travels:e.travels,articles:e.articles}}),e._v(" "),r("div",{staticClass:"w-full flex justify-end"},[r("Btn",{staticClass:"m-4",attrs:{"icon-btn":"",icon:"floppy-disk"},on:{click:e.saveAssociatedAssets}})],1)],1):"article-assets"===e.activeTab?r("div",[r("DraggableArticleAssets",{ref:"articleAssets",attrs:{assets:e.assets,travels:e.travels,articles:e.articles}}),e._v(" "),r("div",{staticClass:"w-full flex justify-end"},[r("Btn",{staticClass:"m-4",attrs:{"icon-btn":"",icon:"floppy-disk"},on:{click:e.saveAssociatedAssets}})],1)],1):e._e()])}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{Tabs:r(352).default,Btn:r(284).default,AssetPickerUploader:r(353).default,AssetPickerLibrary:r(322).default,DraggableTravelAssets:r(354).default,DraggableArticleAssets:r(355).default})}}]);