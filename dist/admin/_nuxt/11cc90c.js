(window.webpackJsonp=window.webpackJsonp||[]).push([[47,3,10,14,15,16,36,40],{471:function(e,t,n){"use strict";n.r(t);n(57);var r=n(470),l={props:{type:r.a.string.def("primary"),label:r.a.string.def("Save"),iconBtn:r.a.bool.def(!1),icon:r.a.string.def("checkmark"),additionalClasses:r.a.string.def("")},computed:{classes:function(){var e=this.iconBtn?"px-4 py-2":"p-2";return"cursor-pointer bg-".concat(this.type||"primary"," ").concat("raw"===this.type?"":"border text-white"," ").concat(e)}}},o=n(36),component=Object(o.a)(l,(function(){var e=this,t=e._self._c;return t("button",{class:[e.classes,e.additionalClasses,"rounded text-center flex items-center"],attrs:{type:"button"},on:{click:function(t){return e.$emit("click")}}},[e.iconBtn?e._e():t("span",[e._v(e._s(e.label))]),e._v(" "),e.icon&&!e.iconBtn?t("span",{staticClass:"pl-2"},[t("Icon",{attrs:{name:e.icon}})],1):t("span",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.label,expression:"label"}]},[t("Icon",{attrs:{name:e.icon}})],1)])}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{Icon:n(472).default})},472:function(e,t,n){"use strict";n.r(t);n(473),n(26);var r=n(470),l={props:{name:r.a.string.def(""),small:r.a.bool.def(!1)}},o=n(36),component=Object(o.a)(l,(function(){var e=this,t=e._self._c;return t("svg",e._g({class:{"fill-current icon":!0,"cursor-pointer":!!e.$listeners,"w-2 h-2":e.small,"w-4 h-4":!e.small}},e.$listeners),[t("use",{attrs:{"xlink:href":"#icon-".concat(e.name)}})])}),[],!1,null,null,null);t.default=component.exports},474:function(e,t,n){"use strict";n.r(t);n(473),n(26);var r=n(470),l={props:{type:r.a.string.def("text"),name:r.a.string.def("input"),id:r.a.string.def("input"),label:r.a.string.def(""),placeholder:r.a.string.def(""),required:r.a.bool.def(!1),disabled:r.a.bool.def(!1),value:r.a.string.def(""),small:r.a.bool.def(!1)}},o=n(36),component=Object(o.a)(l,(function(){var e=this,t=e._self._c;return t("div",{class:{"mt-2 mb-4":!e.small}},[e.label?t("h4",{staticClass:"label font-bold my-4"},[t("span",{staticClass:"bg-white z-10 pr-6"},[e._v(e._s(e.label))])]):e._e(),e._v(" "),t("input",{class:[e.small?"text-xs":"","w-full p-2 rounded border"],attrs:{id:e.id,type:e.type,name:e.name,required:e.required,disabled:e.disabled,placeholder:e.placeholder},domProps:{value:e.value},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.$emit("enter")},input:function(t){return e.$emit("input",t.target.value)}}})])}),[],!1,null,null,null);t.default=component.exports},477:function(e,t,n){"use strict";n.r(t);var r=n(510),l=n.n(r),o=n(470),c=(n(511),{components:{vSelect:l.a},props:{label:o.a.string.def(null),sublabel:o.a.string.def(null),placeholder:o.a.string.def(null),options:o.a.array.def([]),optionLabel:o.a.string.def("label"),multiple:o.a.bool.def(!1),taggable:o.a.bool.def(!1),pushTags:o.a.bool.def(!1),value:o.a.oneOfType([o.a.object,o.a.array]).def(null),small:o.a.bool.def(!1)}}),d=(n(485),n(36)),component=Object(d.a)(c,(function(){var e=this,t=e._self._c;return t("div",[e.label?t("h4",{staticClass:"label font-bold my-4"},[t("span",{staticClass:"bg-white z-10 pr-6"},[e._v(e._s(e.label))])]):e._e(),e._v(" "),e.sublabel?t("p",[e._v(e._s(e.sublabel))]):e._e(),e._v(" "),t("v-select",{attrs:{options:e.options,label:e.optionLabel,multiple:e.multiple,taggable:e.taggable,"push-tags":e.pushTags,placeholder:e.placeholder,value:e.value},on:{input:function(t){return e.$emit("input",t)}}})],1)}),[],!1,null,null,null);t.default=component.exports},478:function(e,t,n){var content=n(486);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(85).default)("afdcce92",content,!0,{sourceMap:!1})},479:function(e,t,n){var content=n(488);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(85).default)("e8fc41cc",content,!0,{sourceMap:!1})},480:function(e,t,n){var content=n(493);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(85).default)("158f622b",content,!0,{sourceMap:!1})},481:function(e,t,n){"use strict";n.r(t);n(25),n(18),n(39),n(20),n(40);var r=n(13),l=(n(30),n(11),n(470)),o=n(31);function c(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function d(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?c(Object(source),!0).forEach((function(t){Object(r.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):c(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var f={props:{assets:l.a.array.def([]),picked:l.a.oneOfType([l.a.object,l.a.array]).def(null),pick:l.a.string.def("one"),pickLimit:l.a.number.def(null),data:l.a.object.def(null)},data:function(){return{pickedImage:null,pickedImages:[]}},mounted:function(){this.picked&&("one"===this.pick?this.pickedImage=this.picked:"multiple"===this.pick&&(this.pickedImages=this.picked))},methods:d(d({},Object(o.b)("modal",["setVisible","setModalId"])),{},{handlePick:function(image){this.pickedImage=image},handlePicks:function(e,t,n){"add"===n?this.pickedImages.push(t):this.pickedImages=this.pickedImages.filter((function(a){return a.asset_id!==t.asset_id}))},handleConfirm:function(){var e="one"===this.pick?this.pickedImage:this.pickedImages;this.$emit("confirm",e),this.setModalId(null),this.setVisible(!1)},handleCancel:function(){this.setModalId(null),this.setVisible(!1)}})},m=n(36),component=Object(m.a)(f,(function(){var e=this,t=e._self._c;return t("portal",{attrs:{to:"modal"}},[t("div",{staticClass:"relative h-full"},["one"===e.pick&&e.pickedImage?t("div",{staticClass:"m-8"},[t("img",{staticClass:"h-48",attrs:{src:e.pickedImage.asset_src}})]):"multiple"===e.pick&&e.pickedImages?t("div",{staticClass:"m-8 flex flex-wrap"},e._l(e.pickedImages,(function(img){return t("div",{key:img.asset_id,staticClass:"mr-4"},[t("img",{staticClass:"h-32 m-2",attrs:{src:img.asset_src}})])})),0):e._e(),e._v(" "),t("AssetPickerLibrary",{attrs:{assets:e.assets,picked:e.picked,pick:e.pick,"pick-limit":e.pickLimit,data:e.data},on:{pick:e.handlePick,picks:e.handlePicks}}),e._v(" "),t("div",{staticClass:"sticky bottom-0 w-full translate-x-0 p-2 bg-white border-t-2 border-gray-500"},[t("div",{staticClass:"flex justify-end"},[t("Btn",{attrs:{label:e.$t("general.confirm")},on:{click:e.handleConfirm}}),e._v(" "),t("Btn",{attrs:{label:e.$t("general.cancel"),type:"secondary"},on:{click:e.handleCancel}})],1)])],1)])}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{AssetPickerLibrary:n(495).default,Btn:n(471).default})},482:function(e,t,n){"use strict";n.r(t);n(26);var r=n(470),l={props:{name:r.a.string.def("textarea"),placeholder:r.a.string.def(""),label:r.a.string.def(null),required:r.a.bool.def(!1),rows:r.a.number.def(4),value:r.a.string.def(""),classes:r.a.string.def("")}},o=n(36),component=Object(o.a)(l,(function(){var e=this,t=e._self._c;return t("div",[e.label?t("h4",{staticClass:"label font-bold my-4"},[t("span",{staticClass:"bg-white z-10 pr-6"},[e._v(e._s(e.label))])]):e._e(),e._v(" "),t("textarea",{class:[e.classes,"w-full p-2 rounded border border-grey-600"],attrs:{name:e.name,placeholder:e.placeholder,required:e.required,rows:e.rows},domProps:{value:e.value},on:{input:function(t){return e.$emit("input",t.target.value)}}})])}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{Textarea:n(482).default})},483:function(e,t,n){"use strict";n.r(t);n(25),n(18),n(30),n(11),n(39),n(20),n(40);var r=n(6),l=n(13),o=(n(52),n(44),n(470)),c=n(31);function d(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function f(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?d(Object(source),!0).forEach((function(t){Object(l.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):d(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var m={props:{id:o.a.string.def("new-block"),type:o.a.string.def("paragraph"),content:o.a.any.def(null),edit:o.a.bool.def(!1),assets:o.a.array.def([]),data:o.a.object.def({})},data:function(){return{imageType:"desktop",model:{desktop:null,mobile:null,playlist:""}}},computed:f({},Object(c.c)("modal",["modalId"])),methods:f(f({},Object(c.b)("modal",["setVisible","setModalId"])),{},{getTools:function(e){return"map-description"===e?["map"]:"anecdote"===e?["anecdote"]:[]},selectImage:function(e){this.imageType=e,this.setModalId("editor-asset"),this.setVisible(!0)},handleConfirm:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var content;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(content="",["image","playlist"].includes(e.type)){t.next=7;break}return t.next=4,e.$refs.textEditor.saveContent();case 4:content=t.sent,t.next=8;break;case 7:"image"===e.type?content={content:{desktop:e.model.desktop||e.content.desktop,mobile:e.model.mobile||e.content.mobile}}:"playlist"===e.type&&(content={content:e.model[e.type]});case 8:e.$emit("confirm",e.type,content,e.id);case 9:case"end":return t.stop()}}),t)})))()},handleCancel:function(){this.$emit("cancel")},handleConfirmImage:function(e){this.model[this.imageType]=e}})},v=n(36),component=Object(v.a)(m,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"my-2"},["image"===e.type?t("div",{staticClass:"flex justify-center"},[t("div",{staticClass:"h-full flex justify-center"},[e.edit||e.model.desktop?t("img",{staticClass:"h-48",attrs:{src:e.model.desktop?e.model.desktop.asset_src:e.content.desktop.asset_src}}):e._e(),e._v(" "),t("div",{class:{"h-full flex items-center ml-4":e.edit||e.model.desktop,"flex justify-center mx-4":!e.edit}},[t("Btn",{attrs:{"icon-btn":"",icon:"pencil",label:e.$t("general.desktop")},on:{click:function(t){return e.selectImage("desktop")}}})],1)]),e._v(" "),t("div",{staticClass:"h-full flex justify-center"},[e.edit||e.model.mobile?t("img",{staticClass:"h-48",attrs:{src:e.model.mobile?e.model.mobile.asset_src:e.content.mobile.asset_src}}):e._e(),e._v(" "),t("div",{class:{"h-full flex items-center ml-4":e.edit||e.model.mobile,"flex justify-center mx-4":!e.edit}},[t("Btn",{attrs:{"icon-btn":"",icon:"pencil",label:e.$t("general.mobile")},on:{click:function(t){return e.selectImage("mobile")}}})],1)])]):"playlist"===e.type?t("div",[t("InputText",{attrs:{value:e.edit?e.content:""},model:{value:e.model.playlist,callback:function(t){e.$set(e.model,"playlist",t)},expression:"model.playlist"}})],1):t("div",[t("TextEditor",{ref:"textEditor",attrs:{name:"block-editor-comp-".concat(e.type),data:e.edit?e.content:null,anecdotes:e.data?e.data.anecdotes:null,tools:e.getTools(e.type)}})],1),e._v(" "),t("div",{staticClass:"flex justify-center my-2"},[t("Btn",{attrs:{label:e.$t("general.confirm")},on:{click:e.handleConfirm}}),e._v(" "),t("Btn",{attrs:{label:e.$t("general.cancel"),type:"secondary"},on:{click:e.handleCancel}})],1),e._v(" "),"editor-asset"===e.modalId?t("AssetsModal",{attrs:{assets:e.assets,data:e.data,picked:e.edit?e.content[e.imageType]:null},on:{confirm:e.handleConfirmImage}}):e._e()],1)}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{Btn:n(471).default,InputText:n(474).default,TextEditor:n(494).default,AssetsModal:n(481).default})},484:function(e,t,n){"use strict";n.r(t);var r={},l=n(36),component=Object(l.a)(r,(function(){var e=this,t=e._self._c;return t("portal",{attrs:{to:"modal"}},[t("div",{staticClass:"flex flex-col justify-center items-center m-16"},[t("h4",{staticClass:"font-bold text-lg text-center mb-4"},[e._v(e._s(e.$t("general.sure")))]),e._v(" "),t("div",{staticClass:"flex justify-center"},[t("Btn",{attrs:{label:e.$t("general.confirm"),"additional-classes":"mr-4"},on:{click:function(t){return e.$emit("confirm")}}}),e._v(" "),t("Btn",{attrs:{label:e.$t("general.cancel"),type:"secondary"},on:{click:function(t){return e.$emit("cancel")}}})],1)])])}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{Btn:n(471).default})},485:function(e,t,n){"use strict";n(478)},486:function(e,t,n){var r=n(84)(!1);r.push([e.i,'.vs__dropdown-toggle{border-width:1px}.label{position:relative;overflow:hidden;display:flex;align-items:center}.label:after{content:"";position:absolute;padding-left:2px;width:100%;height:1px;background-color:#000}',""]),e.exports=r},487:function(e,t,n){"use strict";n(479)},488:function(e,t,n){var r=n(84)(!1);r.push([e.i,"#map{height:100%;min-height:400px}#infowindow-content .title{font-weight:700}#infowindow-content{display:none}#map #infowindow-content{display:inline}",""]),e.exports=r},489:function(e,t,n){"use strict";n.r(t);n(25),n(18),n(30),n(11),n(39),n(20),n(40);var r=n(13),l=n(470),o=n(31);function c(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function d(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?c(Object(source),!0).forEach((function(t){Object(r.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):c(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var f={props:{anecdotes:l.a.array.def([])},data:function(){return{anecdoteModel:{}}},methods:d(d({},Object(o.b)("editor",["setValue"])),{},{handleInput:function(input){this.setValue(input),this.anecdoteModel=input}})},m=n(36),component=Object(m.a)(f,(function(){var e=this,t=e._self._c;return t("portal",{attrs:{to:"modal"}},[t("div",{staticClass:"p-8"},[t("Select",{attrs:{options:e.anecdotes,"option-label":"anecdote_title",value:e.anecdoteModel},on:{input:e.handleInput}}),e._v(" "),t("div",{staticClass:"flex justify-end my-4"},[t("Btn",{attrs:{label:e.$t("general.confirm"),"additional-classes":"confirm-anecdote"}})],1)],1)])}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{Select:n(477).default,Btn:n(471).default})},490:function(e,t,n){"use strict";n.r(t);var r={},l=(n(487),n(36)),component=Object(l.a)(r,(function(){var e=this,t=e._self._c;return t("portal",{attrs:{to:"modal"}},[t("div",{staticClass:"p-8"},[t("input-text",{attrs:{id:"pac-input",type:"text",placeholder:"Lieu - Luogo"}}),e._v(" "),t("div",{attrs:{id:"map"}}),e._v(" "),t("div",{attrs:{id:"infowindow-content"}},[t("img",{attrs:{id:"place-icon",src:"",width:"16",height:"16"}}),e._v(" "),t("span",{staticClass:"title",attrs:{id:"place-name"}}),t("br"),e._v(" "),t("span",{attrs:{id:"place-address"}})]),e._v(" "),t("div",{staticClass:"flex justify-end my-4"},[t("Btn",{attrs:{label:e.$t("general.confirm"),"additional-classes":"confirm-map-point"}})],1)],1)])}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{InputText:n(474).default,Btn:n(471).default})},491:function(e,t,n){var content=n(508);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(85).default)("79a66dfc",content,!0,{sourceMap:!1})},492:function(e,t,n){"use strict";n(480)},493:function(e,t,n){var r=n(84)(!1);r.push([e.i,"[id^=editor]{width:100%;min-width:50vw;padding:20px;border:1px solid #d3d3d3;min-height:200px}",""]),e.exports=r},494:function(e,t,n){"use strict";n.r(t);n(26),n(25),n(18),n(30),n(11),n(39),n(20),n(40);var r=n(6),l=n(179),o=n(13),c=(n(52),n(57),n(51),n(470)),d=n(31),f=n(513),m=n.n(f),v=n(514),h=n.n(v),_=n(180),y=n(181),k=(n(44),n(58),n(45),n(32),n(106),n(139),function(){function e(t){var n=t.api;t.config;Object(_.a)(this,e),this.api=n,this.store=window.$nuxt.$store,this.button=null,this._state=!1,this.address=void 0,this.input=null,this.mapInitialized=!1,this.tag="SPAN",this.class="map-point"}return Object(y.a)(e,[{key:"state",get:function(){return this._state},set:function(e){this._state=e,this.button.classList.toggle(this.api.styles.inlineToolButtonActive,e)}},{key:"render",value:function(){return this.button=document.createElement("button"),this.button.type="button",this.button.innerHTML='<svg class="fill-current w-4 h-4 icon cursor-pointer">\n                              <use xlink:href="#icon-location"></use>\n                            </svg>',this.button}},{key:"surround",value:function(e){this.state?this.unwrap(e):this.wrap(e)}},{key:"wrap",value:function(e){var t=e.extractContents(),n=document.createElement(this.tag),r=Math.floor(1e4*Math.random());n.classList.add(this.class),n.setAttribute("id","map-point-".concat(r)),n.appendChild(t),e.insertNode(n),this.api.selection.expandToTag(n)}},{key:"unwrap",value:function(e){var t=this.api.selection.findParentTag(this.tag,this.class),text=e.extractContents();t.remove(),e.insertNode(text)}},{key:"checkState",value:function(){var e=this.api.selection.findParentTag(this.tag);this.state=e&&Array.from(e.classList).includes("map-point"),this.mapPointId=e&&e.getAttribute("id"),this.state?this.showActions():this.hideActions()}},{key:"renderActions",value:function(){return this.anecdotePicker=document.createElement("input"),this.anecdotePicker.type="text",this.anecdotePicker.value="",this.anecdotePicker.hidden=!0,this.anecdotePicker}},{key:"showActions",value:function(){var e=this;console.log("show action",this.mapPointId),this.store.commit("modal/setVisible",!0),this.store.commit("modal/setModalId","map-point"),setTimeout((function(){e.mapInitialized||e.initMap(),document.querySelector(".confirm-map-point").addEventListener("click",(function(t){if(e.address){var n=e.address,address=n.address,r=n.lat,l=n.lng,o=document.querySelector("#".concat(e.mapPointId));o.getAttribute("data-address")||(o.setAttribute("data-address",address),o.setAttribute("data-lat",r),o.setAttribute("data-lng",l)),e.address=null,e.input.value="",e.store.commit("modal/setVisible",!1),e.store.commit("modal/setModalId",null),e.mapPoint=null,e.mapPointId=null}}))}))}},{key:"initMap",value:function(){var e=this,map=new window.google.maps.Map(document.getElementById("map"),{center:{lat:-33.8688,lng:151.2195},zoom:13});this.mapInitialized=!0,this.input=document.getElementById("pac-input");var t=new window.google.maps.places.Autocomplete(this.input);t.bindTo("bounds",map),t.setFields(["address_components","geometry","icon","name"]);var n=new window.google.maps.InfoWindow,r=document.getElementById("infowindow-content");n.setContent(r);var marker=new window.google.maps.Marker({map:map,anchorPoint:new window.google.maps.Point(0,-29)});t.addListener("place_changed",(function(){n.close(),marker.setVisible(!1);var l=t.getPlace();if(l.geometry){l.geometry.viewport?map.fitBounds(l.geometry.viewport):(map.setCenter(l.geometry.location),map.setZoom(17)),marker.setPosition(l.geometry.location),marker.setVisible(!0);var o=l.geometry.location.lat(),c=l.geometry.location.lng(),address="";l.address_components&&(address=[l.address_components[0]&&l.address_components[0].short_name||"",l.address_components[1]&&l.address_components[1].short_name||"",l.address_components[2]&&l.address_components[2].short_name||""].join(" ")),r&&(r.children["place-icon"].src=l.icon,r.children["place-name"].textContent=l.name,r.children["place-address"].textContent=address),n.open(map,marker),e.address={address:address,lat:o,lng:c}}else window.alert("No details available for input: '"+l.name+"'")}))}},{key:"hideActions",value:function(){}}],[{key:"isInline",get:function(){return!0}},{key:"sanitize",get:function(){return{span:!0}}}]),e}()),O=function(){function e(t){var n=t.api;t.config;Object(_.a)(this,e),this.store=window.$nuxt.$store,this.api=n,this.button=null,this._state=!1,this.tag="SPAN",this.class="anecdote"}return Object(y.a)(e,[{key:"state",get:function(){return this._state},set:function(e){this._state=e,this.button.classList.toggle(this.api.styles.inlineToolButtonActive,e)}},{key:"render",value:function(){return this.button=document.createElement("button"),this.button.type="button",this.button.innerHTML=' <svg class="fill-current w-4 h-4 icon cursor-pointer">\n                                <use xlink:href="#icon-file-empty"></use>\n                              </svg>',this.button}},{key:"surround",value:function(e){this.state?this.unwrap(e):this.wrap(e)}},{key:"wrap",value:function(e){var t=e.extractContents(),n=document.createElement(this.tag);n.classList.add(this.class),n.appendChild(t),e.insertNode(n),this.api.selection.expandToTag(n)}},{key:"unwrap",value:function(e){var t=this.api.selection.findParentTag(this.tag,this.class),text=e.extractContents();t.remove(),e.insertNode(text)}},{key:"checkState",value:function(){var e=this.api.selection.findParentTag(this.tag);this.state=e&&Array.from(e.classList).includes("anecdote"),this.state?this.showActions(e):this.hideActions()}},{key:"renderActions",value:function(){return this.anecdotePicker=document.createElement("input"),this.anecdotePicker.type="text",this.anecdotePicker.value="",this.anecdotePicker.hidden=!0,this.anecdotePicker}},{key:"showActions",value:function(e){var t=this;this.store.commit("modal/setVisible",!0),this.store.commit("modal/setModalId","anecdote"),setTimeout((function(){document.querySelector(".confirm-anecdote").addEventListener("click",(function(n){var r=t.store.state.editor.value;e.classList.add("anecdote-".concat(r.anecdote_id)),e.setAttribute("data-title",r.anecdote_title),t.store.commit("modal/setVisible",!1),t.store.commit("modal/setModalId",null)}))}))}},{key:"hideActions",value:function(){}}],[{key:"isInline",get:function(){return!0}},{key:"sanitize",get:function(){return{span:!0}}}]),e}(),j=function(e){var t={paragraph:"p"};return e.blocks.map((function(e){var n=document.createElement(t[e.type]);n.innerHTML=e.data.text;return function e(t){Array.from(t.children).forEach((function(t){t.getAttribute("style")&&t.removeAttribute("style"),Array.from(t.children).length&&e(t)}))}(n),n.outerHTML})).join("")};function w(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}var x={props:{name:c.a.string.def("editor"),data:c.a.object.def({}),anecdotes:c.a.array.def([]),tools:c.a.array.def([])},data:function(){return{editor:null,saveTrigger:!1,toolsMap:{list:h.a,map:{class:k,inlineToolbar:!0,config:{}},anecdote:{class:O,inlineToolbar:!0}}}},computed:function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?w(Object(source),!0).forEach((function(t){Object(o.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):w(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}({},Object(d.c)("modal",["modalId"])),watch:{saveTrigger:function(e,t){e!==t&&this.saveContent()}},mounted:function(){this.editor=new m.a({holder:"editor-".concat(this.name),tools:this.getTools(),data:this.data})},methods:{getTools:function(){var e=this,t={};return[].concat(Object(l.a)(this.tools),["list"]).map((function(n){t[n]=e.toolsMap[n]})),t},saveContent:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n,content;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.editor.save();case 2:return n=t.sent,content=j(n),e.$emit("save",{content:content,rawContent:n}),t.abrupt("return",{content:content,rawContent:n});case 6:case"end":return t.stop()}}),t)})))()}}},C=x,$=(n(492),n(36)),component=Object($.a)(C,(function(){var e=this,t=e._self._c;return t("div",[t("div",{attrs:{id:"editor-".concat(e.name)}}),e._v(" "),"anecdote"===e.modalId?t("AnecdoteModal",{attrs:{anecdotes:e.anecdotes}}):e._e(),e._v(" "),"map-point"===e.modalId?t("MapPointModal"):e._e()],1)}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{AnecdoteModal:n(489).default,MapPointModal:n(490).default})},495:function(e,t,n){"use strict";n.r(t);n(44),n(58),n(25),n(39),n(40);var r=n(6),l=n(13),o=(n(52),n(30),n(11),n(51),n(27),n(70),n(505),n(499),n(138),n(20),n(18),n(46),n(586)),c=n(470),d=n(31);function f(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function m(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?f(Object(source),!0).forEach((function(t){Object(l.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):f(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var v={props:{assets:c.a.array.def([]),pick:c.a.string.def(null),picked:c.a.oneOfType([c.a.array,c.a.object]).def(null),data:c.a.object.def({}),pickLimit:c.a.number.def(null)},data:function(){var e=this.$i18n.locale;return{locale:e,otherLocale:"fr"===e?"it":"fr",pickedAsset:null,pickedAssetsIds:[],assetToRemove:null,assetToEdit:null,filters:{travel:null,place:null}}},computed:m(m({},Object(d.c)("modal",["modalId"])),{},{places:function(){var e=this;return this.data.articles.map((function(article){var t=article["article_place_".concat(e.locale)];if(t)return{key:t.toLowerCase().replaceAll(" ","_"),label:t}})).filter((function(e){return!!e}))},filteredAssets:function(){var e=this;return this.assets.filter((function(t){return e.filters.travel&&e.filters.place?e.filters.travel===Number(t.asset_travel_id)&&!!t["asset_place_".concat(e.locale)]&&e.filters.place===t["asset_place_".concat(e.locale)]:!e.filters.travel&&!e.filters.place||(e.filters.travel===Number(t.asset_travel_id)||e.filters.place===t["asset_place_".concat(e.locale)])}))}}),mounted:function(){var e=this;this.locale=this.$i18n.locale,this.picked&&("multiple"===this.pick?this.pickedAssetsIds=this.picked.map((function(p){return p.asset_id})):(this.pickedAsset=this.picked,this.$nextTick((function(){e.initWithPicked()}))))},methods:m(m({},Object(d.b)("modal",["setVisible","setModalId"])),{},{getUploadDate:function(e){var t=e.split("_")[0];return Object(o.a)(new Date(Number(t)),"dd/MM/yyyy")},getTravelTitle:function(e){var t=this.data.travels.find((function(t){return t.travel_id===e}));return t["travel_title_".concat(this.locale)]?t["travel_title_".concat(this.locale)]:'<span class="italic text-gray-400">'.concat(t["travel_title_".concat(this.otherLocale)],"</span>")},initWithPicked:function(){var e=this;this.$refs.asset.forEach((function(a){Number(a.getAttribute("id"))!==Number(e.pickedAsset.asset_id)?a.classList.add("opacity-50"):a.classList.remove("opacity-50")}))},handlePickOneAsset:function(e){var t=this;this.$refs.asset.forEach((function(a){t.pickedAsset&&t.pickedAsset.asset_id===e.asset_id?a.classList.remove("opacity-50"):Number(a.getAttribute("id"))!==Number(e.asset_id)?a.classList.add("opacity-50"):a.classList.remove("opacity-50")})),this.pickedAsset=e},handleAssetPick:function(e,t){var n,r=this;(t.stopPropagation(),t.preventDefault(),"one"===this.pick&&(this.handlePickOneAsset(e),this.$emit("pick",e)),"multiple"===this.pick)&&((!this.pickLimit||this.pickedAssetsIds.length<this.pickLimit||this.pickedAssetsIds.length===this.pickLimit&&!t.target.checked)&&(t.target.checked?(n="add",this.pickedAssetsIds.push(e.asset_id)):(n="remove",this.pickedAssetsIds=this.pickedAssetsIds.filter((function(a){return a!==e.asset_id}))),this.pickedAssetsIds.length===this.pickLimit?this.$refs.assetContainer.forEach((function(a){r.pickedAssetsIds.includes(Number(a.getAttribute("id").replace("container_","")))||(a.classList.add("pointer-events-none"),a.classList.add("opacity-50"))})):this.$refs.assetContainer.forEach((function(a){a.classList.remove("pointer-events-none"),a.classList.remove("opacity-50")})),this.$emit("picks",this.pickedAssetsIds,e,n)))},handleEdit:function(e){this.assetToEdit=e,this.setVisible(!0),this.setModalId("asset-edit")},handleRemove:function(e){this.assetToRemove=e,this.setVisible(!0),this.setModalId("asset-remove")},removeAsset:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$axios.post("/api/assets/delete",{ids:[e.assetToRemove.asset_id],names:[e.assetToRemove.asset_name]});case 3:e.$toast.success(e.$t("assets.removed_success")),e.$emit("change"),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0),e.$toast.error(e.$t("assets.removed_error"));case 11:return t.prev=11,e.closeRemoveModal(),e.assetToRemove=null,t.finish(11);case 15:case"end":return t.stop()}}),t,null,[[0,7,11,15]])})))()},updateAsset:function(e,t){var n=this;return Object(r.a)(regeneratorRuntime.mark((function r(){var o,c;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return c=m(m({},t),{},(o={},Object(l.a)(o,"asset_desc_".concat(n.locale),e.description),Object(l.a)(o,"asset_title_".concat(n.locale),e.title),Object(l.a)(o,"asset_article_ids",JSON.stringify(e.article_ids.map((function(e){return Number(e.article_id)})))),Object(l.a)(o,"asset_travel_id",Number(e.travel.travel_id)),o)),r.prev=1,r.next=4,n.$axios.put("/api/assets/".concat(t.asset_id),c);case 4:n.$toast.success(n.$t("assets.updated_success")),n.$emit("change"),n.assetToEdit=null,r.next=13;break;case 9:r.prev=9,r.t0=r.catch(1),console.log(r.t0),n.$toast.error(n.$t("assets.updated_error"));case 13:case"end":return r.stop()}}),r,null,[[1,9]])})))()},closeRemoveModal:function(){this.setVisible(!1),this.setModalId(null)},handleFilter:function(e){e.travel_id?this.filters.travel=this.filters.travel===e.travel_id?null:e.travel_id:this.filters.place=this.filters.place===e.label?null:e.label}})},h=(n(507),n(36)),component=Object(h.a)(v,(function(){var e=this,t=e._self._c;return t("section",[t("div",{staticClass:"m-6"},[t("div",{staticClass:"flex my-4"},[t("div",{staticClass:"w-1/2 flex flex-col items-center"},[t("h4",[e._v(e._s(e.$t("assets.filter_by_travel")))]),e._v(" "),t("div",{staticClass:"flex flex-wrap justify-center w-full"},e._l(e.data.travels,(function(n){return t("Tag",{key:n.travel_id,staticClass:"mr-2 my-2",attrs:{tag:n["travel_title_".concat(e.locale)],selectable:"",selected:e.filters.travel===n.travel_id},on:{click:function(t){return e.handleFilter(n)}}})})),1)]),e._v(" "),t("div",{staticClass:"w-1/2 flex flex-col items-center"},[t("h4",[e._v(e._s(e.$t("assets.filter_by_place")))]),e._v(" "),t("div",{staticClass:"flex flex-wrap justify-center w-full"},e._l(e.places,(function(n){return t("Tag",{key:n.key,staticClass:"mr-2 my-2",attrs:{tag:n.label,selectable:"",selected:e.filters.place===n.label},on:{click:function(t){return e.handleFilter(n)}}})})),1)])]),e._v(" "),t("div",{staticClass:"flex flex-wrap justify-center"},[e._l(e.filteredAssets,(function(n,i){return t("div",{key:i,ref:"assetContainer",refInFor:!0,class:{"w-64 mr-4 my-2 relative":!0,"h-80 border border-grey-100":!e.pick},attrs:{id:"container_".concat(n.asset_id)}},["multiple"===e.pick?t("span",{staticClass:"absolute top-0 right-0"},[t("input",{staticClass:"mr-2 mt-2 z-20",attrs:{type:"checkbox"},domProps:{checked:e.pickedAssetsIds.includes(n.asset_id)},on:{change:function(t){return e.handleAssetPick(n,t)}}})]):e._e(),e._v(" "),t("div",{class:{"backdrop-container max-h-2/3 overflow-hidden relative flex justify-center items-center":!e.pick}},[e.pick?e._e():t("div",{staticClass:"backdrop opacity-0 absolute inset-0 h-full w-full hover:opacity-100 transition-opacity duration-300 bg-blue-100 bg-opacity-50"}),e._v(" "),e.pick?e._e():t("div",{staticClass:"backdrop-content z-10 flex absolute inset-0 justify-center items-center opacity-0"},[t("Btn",{attrs:{"icon-btn":"",icon:"pencil"},on:{click:function(t){return e.handleEdit(n)}}}),e._v(" "),t("Btn",{attrs:{"icon-btn":"",type:"secondary",icon:"bin"},on:{click:function(t){return e.handleRemove(n)}}})],1),e._v(" "),t("img",{ref:"asset",refInFor:!0,class:{"max-h-2/3":!e.pick,"cursor-pointer":e.pick,"w-full overflow-hidden":!0},attrs:{id:n.asset_id,src:n.asset_src},on:{click:function(t){return e.handleAssetPick(n,t)}}})]),e._v(" "),e.pick?e._e():t("div",{staticClass:"asset__infos p-4"},[n["asset_title_".concat(e.$i18n.locale)]?t("p",{staticClass:"font-bold text-lg"},[e._v("\n            "+e._s(n["asset_title_".concat(e.$i18n.locale)])+"\n          ")]):e._e(),e._v(" "),n["asset_place_".concat(e.$i18n.locale)]?t("p",{staticClass:"font-bold text-sm"},[e._v("\n            "+e._s(n["asset_place_".concat(e.$i18n.locale)])+"\n          ")]):e._e(),e._v(" "),t("p",{staticClass:"text-sm text-gray-600"},[e._v("\n            "+e._s(e.$t("assets.uploaded"))+"\n            "+e._s(e.getUploadDate(n.asset_name))+"\n          ")]),e._v(" "),n["asset_desc_".concat(e.$i18n.locale)]?t("p",{staticClass:"text-sm text-gray-600"},[e._v("\n            "+e._s(e.$t("assets.description"))+"\n            "+e._s(n["asset_desc_".concat(e.$i18n.locale)])+"\n          ")]):e._e(),e._v(" "),n.asset_travel_id?t("p",{staticClass:"text-sm text-gray-600 font-bold",domProps:{innerHTML:e._s(e.getTravelTitle(n.asset_travel_id))}}):e._e()])])})),e._v(" "),e.filteredAssets.length?e._e():t("div",{staticClass:"flex justify-center max-w-1/4 my-16"},[e._v("\n        "+e._s(e.$t("assets.filtered_empty"))+"\n      ")])],2),e._v(" "),"asset-remove"===e.modalId?t("RemoveModal",{on:{confirm:e.removeAsset,cancel:e.closeRemoveModal}}):e._e(),e._v(" "),"asset-edit"===e.modalId?t("EditAssetModal",{attrs:{travels:e.data.travels,articles:e.data.articles,image:e.assetToEdit},on:{confirm:e.updateAsset,cancel:e.closeRemoveModal}}):e._e()],1)])}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{Tag:n(496).default,Btn:n(471).default,RemoveModal:n(484).default,EditAssetModal:n(500).default})},496:function(e,t,n){"use strict";n.r(t);n(57);var r=n(470),l={props:{deletable:r.a.bool.def(!1),selectable:r.a.bool.def(!1),selected:r.a.bool.def(!1),tag:r.a.string.def("")},computed:{color:function(){var e=["gray","indigo","red","orange","yellow","green","teal","blue","purple","pink"];return"".concat(this.selectable&&!this.selected?"border-2 border-":"text-white bg-").concat(e[Math.floor(Math.random()*(e.length-1))],"-500")}}},o=n(36),component=Object(o.a)(l,(function(){var e=this,t=e._self._c;return t("div",{class:[e.color,"text-xs rounded-md px-2 py-1",{"cursor-pointer":e.selectable}],on:{click:function(t){return e.$emit("click")}}},[t("span",[e._v(e._s(e.tag?"#".concat(e.tag):"# No place"))]),e._v(" "),e.deletable?t("span",{staticClass:"cursor-pointer font-bold",on:{click:function(t){return e.$emit("remove",e.tag)}}},[e._v("x")]):e._e()])}),[],!1,null,null,null);t.default=component.exports},497:function(e,t,n){"use strict";n.r(t);n(44);var r=n(470),l={props:{id:r.a.string.def("block"),position:r.a.number.def(0),type:r.a.string.def(null),content:r.a.any.def(null),assets:r.a.array.def([]),data:r.a.object.def({}),rawContent:r.a.object.def({})},data:function(){return{isEditing:!1,actions:[{key:"edit",icon:"pencil"},{key:"remove",icon:"cross"},{key:"up",icon:"arrow-up2"},{key:"down",icon:"arrow-down2"}]}},methods:{handleAction:function(e){this.$emit(e.key,this.id),"edit"===e.key&&(this.isEditing=!0)},confirmModification:function(e,content,t){this.$emit("confirm",e,content,t),this.isEditing=!1}}},o=n(36),component=Object(o.a)(l,(function(){var e=this,t=e._self._c;return t("div",[e.isEditing?t("div",[t("hr"),e._v(" "),t("BlockEditorComp",{attrs:{id:e.id,edit:"",type:e.type,assets:e.assets,data:e.data,content:["image","playlist"].includes(e.type)?e.content:e.rawContent},on:{confirm:e.confirmModification,cancel:function(t){e.isEditing=!1}}})],1):t("div",[t("hr"),e._v(" "),t("div",{staticClass:"my-4"},[t("div",{staticClass:"flex justify-between mb-2"},[t("p",{staticClass:"uppercase"},[e._v(e._s(e.type))]),e._v(" "),t("div",{staticClass:"flex"},e._l(e.actions,(function(n){return t("div",{key:n.key,staticClass:"rounded-full w-8 h-8 mx-1 flex justify-center items-center cursor-pointer border-2 border-black",on:{click:function(t){return e.handleAction(n)}}},[t("Icon",{attrs:{name:n.icon}})],1)})),0)]),e._v(" "),"image"===e.type?t("div",{staticClass:"flex"},[t("div",{staticClass:"mr-2"},[t("img",{staticClass:"h-48",attrs:{src:e.content.desktop?e.content.desktop.asset_src:""}}),e._v(" "),t("p",[e._v(e._s(e.$t("general.desktop")))])]),e._v(" "),t("div",[t("img",{staticClass:"h-48",attrs:{src:e.content.mobile?e.content.mobile.asset_src:""}}),e._v(" "),t("p",[e._v(e._s(e.$t("general.mobile")))])])]):t("p",{domProps:{innerHTML:e._s(e.content)}})])])])}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{Icon:n(472).default,BlockEditorComp:n(483).default})},498:function(e,t,n){var content=n(517);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(85).default)("a91105c0",content,!0,{sourceMap:!1})},499:function(e,t,n){"use strict";var r=n(14),l=n(7),o=n(4),c=n(108),d=n(24),f=n(15),m=n(182),v=n(62),h=n(107),_=n(267),y=n(3),k=n(86).f,O=n(59).f,j=n(19).f,w=n(502),x=n(503).trim,C="Number",$=l.Number,P=$.prototype,I=l.TypeError,M=o("".slice),A=o("".charCodeAt),E=function(e){var t=_(e,"number");return"bigint"==typeof t?t:T(t)},T=function(e){var t,n,r,l,o,c,d,code,f=_(e,"number");if(h(f))throw I("Cannot convert a Symbol value to a number");if("string"==typeof f&&f.length>2)if(f=x(f),43===(t=A(f,0))||45===t){if(88===(n=A(f,2))||120===n)return NaN}else if(48===t){switch(A(f,1)){case 66:case 98:r=2,l=49;break;case 79:case 111:r=8,l=55;break;default:return+f}for(c=(o=M(f,2)).length,d=0;d<c;d++)if((code=A(o,d))<48||code>l)return NaN;return parseInt(o,r)}return+f};if(c(C,!$(" 0o1")||!$("0b1")||$("+0x1"))){for(var B,D=function(e){var t=arguments.length<1?0:$(E(e)),n=this;return v(P,n)&&y((function(){w(n)}))?m(Object(t),n,D):t},N=r?k($):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),S=0;N.length>S;S++)f($,B=N[S])&&!f(D,B)&&j(D,B,O($,B));D.prototype=P,P.constructor=D,d(l,C,D,{constructor:!0})}},500:function(e,t,n){"use strict";n.r(t);n(26),n(18),n(46);var r=n(13),l=(n(30),n(11),n(44),n(58),n(138),n(25),n(39),n(20),n(40),n(470)),o=n(31);function c(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function d(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?c(Object(source),!0).forEach((function(t){Object(r.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):c(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var f={props:{image:l.a.object.def(null),articles:l.a.array.def([]),travels:l.a.array.def([])},data:function(){return{locale:"",model:{name:"",title:"",place:"",description:"",article_ids:[],travel:null}}},mounted:function(){var e=this.$i18n.locale;this.locale=e;var t=this.image,n=t.asset_name,r=t.asset_article_ids,l=t.asset_travel_id;this.model={name:n,title:this.image["asset_title_".concat(e)],place:this.image["asset_place_".concat(e)],description:this.image["asset_desc_".concat(e)],article_ids:r?this.articles.filter((function(article){return r.includes(article.article_id)})):[],travel:l?this.travels.find((function(e){return e.travel_id===l})):null}},methods:d(d({},Object(o.b)("modal",["setVisible","setModalId"])),{},{handleConfirm:function(){this.$emit("confirm",this.model,this.image),this.closeModal()},handleCancel:function(){this.closeModal()},closeModal:function(){this.setModalId(null),this.setVisible(!1)},handleReduce:function(option){return option["article_title_".concat(this.locale)]}})},m=n(36),component=Object(m.a)(f,(function(){var e=this,t=e._self._c;return t("portal",{attrs:{to:"modal"}},[t("div",[t("div",{staticClass:"h-full flex"},[t("div",{staticClass:"m-8"},[t("img",{staticClass:"h-48",attrs:{src:e.image.asset_src}})]),e._v(" "),t("div",{staticClass:"mr-8 mb-8 w-full max-w-2/3"},[t("InputText",{attrs:{label:e.$t("assets.edit.name"),disabled:""},model:{value:e.model.name,callback:function(t){e.$set(e.model,"name",t)},expression:"model.name"}}),e._v(" "),t("InputText",{attrs:{label:e.$t("assets.edit.title")},model:{value:e.model.title,callback:function(t){e.$set(e.model,"title",t)},expression:"model.title"}}),e._v(" "),t("InputText",{attrs:{label:e.$t("assets.edit.place")},model:{value:e.model.place,callback:function(t){e.$set(e.model,"place",t)},expression:"model.place"}}),e._v(" "),t("Textarea",{attrs:{label:e.$t("assets.edit.description")},model:{value:e.model.description,callback:function(t){e.$set(e.model,"description",t)},expression:"model.description"}}),e._v(" "),t("Select",{attrs:{multiple:"",label:e.$t("assets.edit.articles"),options:e.articles,"option-label":"article_title_".concat(e.locale)},model:{value:e.model.article_ids,callback:function(t){e.$set(e.model,"article_ids",t)},expression:"model.article_ids"}}),e._v(" "),t("Select",{attrs:{label:e.$t("assets.edit.travel"),options:e.travels,"option-label":"travel_title_".concat(e.locale)},model:{value:e.model.travel,callback:function(t){e.$set(e.model,"travel",t)},expression:"model.travel"}})],1)]),e._v(" "),t("div",{staticClass:"sticky bottom-0 w-full translate-x-0 p-2 bg-white border-t-2 border-gray-500"},[t("div",{staticClass:"flex justify-end"},[t("Btn",{attrs:{label:e.$t("general.confirm")},on:{click:e.handleConfirm}}),e._v(" "),t("Btn",{attrs:{label:e.$t("general.cancel"),type:"secondary"},on:{click:e.handleCancel}})],1)])])])}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{InputText:n(474).default,Textarea:n(482).default,Select:n(477).default,Btn:n(471).default})},501:function(e,t,n){"use strict";n.r(t);n(57),n(25),n(18),n(39),n(20),n(40);var r=n(13),l=n(179),o=(n(51),n(30),n(11),n(44),n(58),n(266),n(138),n(470));function c(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function d(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?c(Object(source),!0).forEach((function(t){Object(r.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):c(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var f={props:{label:o.a.string.def(""),blocks:o.a.array.def([]),addons:o.a.array.def(null),assets:o.a.array.def([]),data:o.a.object.def({}),removeActions:o.a.array.def([])},data:function(){var e=this,t=this.addons.map((function(e){return"map-description"===e&&(e={key:"map-description",label:"Description avec carte",icon:"map"}),"anecdote"===e&&(e={key:"anecdote",label:"Description avec anecdotes",icon:"file-empty"}),e}));return{orderedBlocks:[],activeAction:null,actions:[].concat([{key:"paragraph",label:"Paragraphe",icon:"paragraph-left"},{key:"subtitle",label:"Sous-titre",icon:"pilcrow"},{key:"image",label:"Image",icon:"image"},{key:"catch",label:"Phrase d'accroche",icon:"bold"},{key:"playlist",label:"Playlist",icon:"spotify"}],Object(l.a)(t)).filter((function(t){return!e.removeActions.includes(t.key)}))}},mounted:function(){this.orderedBlocks=this.blocks?this.blocks.sort((function(a,b){return a.position-b.position})):[]},methods:{confirmModification:function(e,content,t){"new-block"===t?(this.createNewBlock(e,content),this.activeAction=null):this.orderedBlocks=this.orderedBlocks.map((function(n){return n.id===t&&("image"===e?n.content=content.content:n=d(d({},n),content)),n}))},createNewBlock:function(e,content){var t=Math.floor(1e3*Math.random()),component=d({id:"".concat(e,"-").concat(t),type:e,position:this.orderedBlocks.length},content);this.orderedBlocks.push(component)},handleOrder:function(e,t){var n=this.orderedBlocks.find((function(e){return e.id===t}));if("up"===e&&n.position>0){var r=this.orderedBlocks.find((function(e){return e.position===n.position-1})).id;this.orderedBlocks=this.orderedBlocks.map((function(b){return b.id===t?b.position-=1:b.id===r&&(b.position+=1),b})).sort((function(a,b){return a.position-b.position}))}else if("down"===e&&n.position<this.orderedBlocks.length-1){var l=this.orderedBlocks.find((function(e){return e.position===n.position+1})).id;this.orderedBlocks=this.orderedBlocks.map((function(b){return b.id===t?b.position+=1:b.id===l&&(b.position-=1),b})).sort((function(a,b){return a.position-b.position}))}},handleRemove:function(e){var t=this.orderedBlocks.find((function(b){return b.id===e}));this.orderedBlocks=this.orderedBlocks.map((function(b){return b.position>t.position&&(b.position-=1),b})).filter((function(b){return b.id!==e}))},getBlocks:function(){return this.orderedBlocks}}},m=f,v=n(36),component=Object(v.a)(m,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"mt-16"},[e.label?t("h4",{staticClass:"label font-bold my-4"},[t("span",{staticClass:"bg-white z-10 pr-6"},[e._v(e._s(e.label))])]):e._e(),e._v(" "),t("div",{staticClass:"flex justify-center flex-wrap mb-4"},e._l(e.actions,(function(n){return t("div",{key:n.key,staticClass:"border-2 border-black w-24 h-24 rounded-full flex flex-col items-center justify-center text-sm font-bold cursor-pointer text-center p-4 m-2",on:{click:function(t){e.activeAction=n.key}}},[t("p",[e._v(e._s(n.label))]),e._v(" "),t("div",[t("Icon",{attrs:{name:n.icon}})],1)])})),0),e._v(" "),e.activeAction?t("div",{staticClass:"my-4"},[t("BlockEditorComp",{attrs:{type:e.activeAction,assets:e.assets,data:e.data},on:{confirm:e.confirmModification,cancel:function(t){e.activeAction=null}}})],1):e._e(),e._v(" "),t("div",{staticClass:"my-4"},e._l(e.orderedBlocks,(function(n,i){return t("BlockPreview",e._b({key:"".concat(n.type,"-").concat(i,"-").concat(n.position),attrs:{data:e.data,assets:e.assets},on:{up:function(t){return e.handleOrder("up",t)},down:function(t){return e.handleOrder("down",t)},remove:e.handleRemove,confirm:e.confirmModification}},"BlockPreview",n,!1))})),1)])}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{Icon:n(472).default,BlockEditorComp:n(483).default,BlockPreview:n(497).default})},502:function(e,t,n){var r=n(4);e.exports=r(1..valueOf)},503:function(e,t,n){var r=n(4),l=n(41),o=n(16),c=n(504),d=r("".replace),f="["+c+"]",m=RegExp("^"+f+f+"*"),v=RegExp(f+f+"*$"),h=function(e){return function(t){var n=o(l(t));return 1&e&&(n=d(n,m,"")),2&e&&(n=d(n,v,"")),n}};e.exports={start:h(1),end:h(2),trim:h(3)}},504:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},505:function(e,t,n){n(506)},506:function(e,t,n){"use strict";var r=n(2),l=n(8),o=n(4),c=n(41),d=n(9),f=n(47),m=n(140),v=n(16),h=n(63),_=n(183),y=n(268),k=n(10),O=n(34),j=k("replace"),w=TypeError,x=o("".indexOf),C=o("".replace),$=o("".slice),P=Math.max,I=function(e,t,n){return n>e.length?-1:""===t?n:x(e,t,n)};r({target:"String",proto:!0},{replaceAll:function(e,t){var n,r,o,k,M,A,E,T,B,D=c(this),N=0,S=0,R="";if(!f(e)){if((n=m(e))&&(r=v(c(_(e))),!~x(r,"g")))throw w("`.replaceAll` does not allow non-global regexes");if(o=h(e,j))return l(o,e,D,t);if(O&&n)return C(v(D),e,t)}for(k=v(D),M=v(e),(A=d(t))||(t=v(t)),E=M.length,T=P(1,E),N=I(k,M,0);-1!==N;)B=A?v(t(M,N,k)):y(M,k,N,[],void 0,t),R+=$(k,S,N)+B,S=N+E,N=I(k,M,N+T);return S<k.length&&(R+=$(k,S)),R}})},507:function(e,t,n){"use strict";n(491)},508:function(e,t,n){var r=n(84)(!1);r.push([e.i,".backdrop,.backdrop-content{transition:opacity .3s}.backdrop-container:hover>.backdrop,.backdrop-container:hover>.backdrop-content{opacity:1}.backdrop-container:hover>.backdrop{filter:blur(5px) grayscale(.7)}",""]),e.exports=r},512:function(e,t,n){"use strict";n.r(t);var r=n(470),l={props:{isNew:r.a.bool.def(!1),isPublished:r.a.bool.def(!1),saveOnly:r.a.bool.def(!1),canRemove:r.a.bool.def(!1)}},o=n(36),component=Object(o.a)(l,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"flex justify-center items-center"},[t("div",{class:[{"w-2/3":!e.saveOnly,"mx-8":e.saveOnly},"flex flex-col items-end"]},[t("div",{staticClass:"flex mt-8 mb-24"},[t("Btn",{attrs:{"icon-btn":"",label:e.$t("general.save"),icon:"floppy-disk"},on:{click:function(t){return e.$emit("save")}}}),e._v(" "),e.saveOnly&&e.canRemove?t("span",[e.isNew?e._e():t("Btn",{attrs:{"icon-btn":"",label:e.$t("general.remove"),icon:"bin"},on:{click:function(t){return e.$emit("remove")}}})],1):e._e(),e._v(" "),e.saveOnly?e._e():t("span",[t("Btn",{attrs:{"icon-btn":"",label:e.$t("general.publish"),icon:"rocket"},on:{click:function(t){return e.$emit("publish")}}}),e._v(" "),e.isNew?e._e():t("Btn",{attrs:{"icon-btn":"",label:e.$t("general.remove"),icon:"bin"},on:{click:function(t){return e.$emit("remove")}}}),e._v(" "),e.isPublished?t("Btn",{attrs:{"icon-btn":"",type:"error",label:e.$t("general.unpublish"),icon:"fire"},on:{click:function(t){return e.$emit("unpublish")}}}):e._e()],1)],1),e._v(" "),e._t("default"),e._v(" "),t("div",{staticClass:"flex mt-24 mb-8"},[t("Btn",{attrs:{"icon-btn":"",label:e.$t("general.save"),icon:"floppy-disk"},on:{click:function(t){return e.$emit("save")}}}),e._v(" "),e.saveOnly&&e.canRemove?t("span",[e.isNew?e._e():t("Btn",{attrs:{"icon-btn":"",label:e.$t("general.remove"),icon:"bin"},on:{click:function(t){return e.$emit("remove")}}})],1):e._e(),e._v(" "),e.saveOnly?e._e():t("span",[t("Btn",{attrs:{"icon-btn":"",label:e.$t("general.publish"),icon:"rocket"},on:{click:function(t){return e.$emit("publish")}}}),e._v(" "),e.isNew?e._e():t("Btn",{attrs:{"icon-btn":"",label:e.$t("general.remove"),icon:"bin"},on:{click:function(t){return e.$emit("remove")}}}),e._v(" "),e.isPublished?t("Btn",{attrs:{"icon-btn":"",type:"error",label:e.$t("general.unpublish"),icon:"fire"},on:{click:function(t){return e.$emit("unpublish")}}}):e._e()],1)],1)],2)])}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{Btn:n(471).default})},516:function(e,t,n){"use strict";n(498)},517:function(e,t,n){var r=n(84)(!1);r.push([e.i,".mx-datepicker{width:100%}.mx-input{border-width:1px;border-color:#e2e8f0}",""]),e.exports=r},518:function(e,t,n){"use strict";n.r(t);n(25),n(18),n(30),n(11),n(39),n(20),n(40);var r=n(13),l=n(470),o=n(31);function c(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function d(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?c(Object(source),!0).forEach((function(t){Object(r.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):c(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var f={props:{id:l.a.string.def(""),label:l.a.string.def("Choose an image"),image:l.a.object.def(null),assets:l.a.array.def([]),data:l.a.object.def(null)},data:function(){return{imageModel:null,realId:Math.floor(1e4*Math.random())}},computed:d({},Object(o.c)("modal",["visible","modalId"])),mounted:function(){this.image&&(this.imageModel=this.image),this.id&&(this.realId=this.id)},methods:d(d({},Object(o.b)("modal",["setVisible","setModalId"])),{},{openModal:function(){this.setVisible(!0),this.setModalId("pick-image-".concat(this.id))},confirmImage:function(image){this.imageModel=image,this.$emit("change",image)}})},m=n(36),component=Object(m.a)(f,(function(){var e=this,t=e._self._c;return t("div",[e.label?t("h4",{staticClass:"label font-bold my-4"},[t("span",{staticClass:"bg-white z-10 pr-6"},[e._v(e._s(e.label))])]):e._e(),e._v(" "),t("div",[e.imageModel?t("div",{staticClass:"justify-self-center"},[t("img",{staticClass:"h-56",attrs:{src:e.imageModel.asset_src}})]):e._e(),e._v(" "),t("div",{staticClass:"flex justify-end w-full"},[t("Btn",{attrs:{"icon-btn":"",icon:e.image?"pencil":"plus"},on:{click:e.openModal}})],1),e._v(" "),e.modalId==="pick-image-".concat(e.id)?t("AssetsModal",{attrs:{assets:e.assets,picked:e.imageModel,data:e.data},on:{confirm:e.confirmImage}}):e._e()],1)])}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{Btn:n(471).default,AssetsModal:n(481).default})},519:function(e,t,n){"use strict";n.r(t);var r=n(470),l=n(524),o=(n(526),n(527),{components:{DatePicker:l.default},props:{label:r.a.string.def(null),model:r.a.array.def(null),placeholder:r.a.string.def(null)},data:function(){return{dateModel:[new Date,new Date]}},watch:{dateModel:function(e,t){e!==t&&this.$emit("change",e)}},mounted:function(){this.model&&(this.dateModel=this.model)}}),c=(n(516),n(36)),component=Object(c.a)(o,(function(){var e=this,t=e._self._c;return t("div",[e.label?t("h4",{staticClass:"label font-bold my-4"},[t("span",{staticClass:"bg-white z-10 pr-6"},[e._v(e._s(e.label))])]):e._e(),e._v(" "),t("date-picker",{attrs:{type:"date",range:"",placeholder:e.placeholder,"value-type":"timestamp"},model:{value:e.dateModel,callback:function(t){e.dateModel=t},expression:"dateModel"}})],1)}),[],!1,null,null,null);t.default=component.exports},523:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return f}));n(18),n(30),n(39),n(40);var r=n(13),l=n(29);n(138),n(11),n(20),n(25),n(27),n(70);function o(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function c(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?o(Object(source),!0).forEach((function(t){Object(r.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):o(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}function d(e,t){var data=t.data,n=t.locale,r=t.otherData,l=void 0===r?{}:r;return m[e].input(data,n,l)}function f(e,t){var data=t.data,n=t.locale,r=t.otherData,l=void 0===r?{}:r;return m[e].output(data,n,l)}var m={travel:{input:function(e,t,n){var r="fr"===t?"it":"fr";return{id:e.travel_id,published:!!e["travel_published_".concat(t)],published_date:e["travel_published_date_".concat(t)]||"",same_start_end:!!e.travel_same_start_end,title:e["travel_title_".concat(t)]||'<span class="italic">'.concat(e["travel_title_".concat(r)],"</span>"),slug:e["travel_slug_".concat(t)]||"",category:e.travel_category?n.categories.find((function(t){return t.category_id===e.travel_category})):{},cover_desktop:e["travel_cover_".concat(t)]?n.assets.find((function(n){return n.asset_id===e["travel_cover_".concat(t)]})):null,cover_mobile:e["travel_cover_mobile_".concat(t)]?n.assets.find((function(n){return n.asset_id===e["travel_cover_mobile_".concat(t)]})):null,countries:e["travel_countries_".concat(t)],dates:[e.travel_start_date,e.travel_end_date],hashtags:e.travel_hashtags||[],playlist:e["travel_playlist_".concat(t)]||"",short_desc:e["travel_desc_".concat(t)]||"",long_desc:e["travel_long_desc_".concat(t)]||[]}},output:function(e,t,n){var o,d=e.id?n.travels.find((function(t){return e.id===t.travel_id})):null;d&&Object.keys(d).forEach((function(e){"object"===Object(l.a)(d[e])&&(d[e]=JSON.stringify(d[e]))}));var f=d||{};return f=c(c({},f),{},(o={},Object(r.a)(o,"travel_title_".concat(t),e.title),Object(r.a)(o,"travel_category",e.category.category_id),Object(r.a)(o,"travel_cover_".concat(t),e.cover_desktop?e.cover_desktop.asset_id:null),Object(r.a)(o,"travel_cover_mobile_".concat(t),e.cover_mobile?e.cover_mobile.asset_id:null),Object(r.a)(o,"travel_countries_".concat(t),JSON.stringify(e.countries)),Object(r.a)(o,"travel_slug_".concat(t),e.slug),Object(r.a)(o,"travel_desc_".concat(t),e.short_desc),Object(r.a)(o,"travel_playlist_".concat(t),e.playlist),Object(r.a)(o,"travel_long_desc_".concat(t),JSON.stringify(e.long_desc)),Object(r.a)(o,"travel_start_date",e.dates[0]),Object(r.a)(o,"travel_end_date",e.dates[1]),Object(r.a)(o,"travel_hashtags",JSON.stringify(e.hashtags)),o))}},article:{input:function(article,e,t){var n="fr"===e?"it":"fr";return{id:article.article_id,published:!!article["article_published_".concat(e)],published_date:article["article_published_date_".concat(e)]||"",title:article["article_title_".concat(e)]||'<span class="italic">'.concat(article["article_title_".concat(n)],"</span>"),slug:article["article_slug_".concat(e)]||"",cover_desktop:article["article_cover_".concat(e)]?t.assets.find((function(t){return t.asset_id===article["article_cover_".concat(e)]})):null,cover_mobile:article["article_cover_mobile_".concat(e)]?t.assets.find((function(t){return t.asset_id===article["article_cover_mobile_".concat(e)]})):null,place:article["article_place_".concat(e)]||"",country:{key:article["article_country_".concat(e)].toLowerCase().replace(" ","_"),label:article["article_country_".concat(e)]},size:article["article_size_".concat(e)],travel:article.article_travel_id?t.travels.find((function(e){return e.travel_id===article.article_travel_id})):null,dates:[article.article_start_date,article.article_end_date],gallery:article["article_gallery_".concat(e)]||[],short_desc:article["article_short_desc_".concat(e)]||"",long_desc:article["article_long_desc_".concat(e)]||[]}},output:function(article,e,t){var n,o=article.id?t.articles.find((function(e){return article.id===e.article_id})):null;o&&Object.keys(o).forEach((function(e){"object"===Object(l.a)(o[e])&&(o[e]=JSON.stringify(o[e]))}));var d=o||{};return d=c(c({},d),{},(n={},Object(r.a)(n,"article_title_".concat(e),article.title),Object(r.a)(n,"article_cover_".concat(e),article.cover_desktop?article.cover_desktop.asset_id:null),Object(r.a)(n,"article_cover_mobile_".concat(e),article.cover_mobile?article.cover_mobile.asset_id:null),Object(r.a)(n,"article_country_".concat(e),article.country.label),Object(r.a)(n,"article_place_".concat(e),article.place),Object(r.a)(n,"article_slug_".concat(e),article.slug),Object(r.a)(n,"article_short_desc_".concat(e),article.short_desc),Object(r.a)(n,"article_long_desc_".concat(e),JSON.stringify(article.long_desc)),Object(r.a)(n,"article_gallery_".concat(e),JSON.stringify(article.gallery)),Object(r.a)(n,"article_size_".concat(e),article.size.key),Object(r.a)(n,"article_start_date",article.dates[0]),Object(r.a)(n,"article_end_date",article.dates[1]),Object(r.a)(n,"article_travel_id",article.travel.travel_id),n))}}}},531:function(e,t,n){"use strict";n.r(t);var r=n(179),l=(n(25),n(18),n(39),n(20),n(40),n(13)),o=(n(30),n(11),n(470)),c=n(31);function d(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function f(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?d(Object(source),!0).forEach((function(t){Object(l.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):d(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var m={props:{id:o.a.string.def(null),label:o.a.string.def("Choose an image"),gallery:o.a.array.def([]),assets:o.a.array.def([]),data:o.a.object.def({})},data:function(){return{galleryModel:[],realId:Math.floor(1e4*Math.random())}},computed:f(f({},Object(c.c)("modal",["visible","modalId"])),{},{isEditable:function(){return this.galleryModel&&this.galleryModel.length<4}}),mounted:function(){this.gallery&&this.gallery.length&&(this.galleryModel=this.gallery),this.id&&(this.realId=this.id)},methods:f(f({},Object(c.b)("modal",["setVisible","setModalId"])),{},{openModal:function(){this.setVisible(!0),this.setModalId("pick-gallery-".concat(this.realId))},confirmGallery:function(e){this.galleryModel=e},removeAsset:function(e){this.galleryModel=this.galleryModel.filter((function(a){return a.asset_id!==e.asset_id}))},getContent:function(){return this.galleryModel}})},v=n(36),component=Object(v.a)(m,(function(){var e=this,t=e._self._c;return t("div",[e.label?t("h4",{staticClass:"label font-bold my-4"},[t("span",{staticClass:"bg-white z-10 pr-6"},[e._v(e._s(e.label))])]):e._e(),e._v(" "),t("div",[e.galleryModel&&e.galleryModel.length?t("div",{staticClass:"flex"},e._l(e.galleryModel,(function(img){return t("div",{key:img.asset_id,staticClass:"mr-4 relative w-1/4"},[t("span",{staticClass:"absolute top-0 right-0 m-2 text-white",on:{click:function(t){return e.removeAsset(img)}}},[t("Icon",{attrs:{name:"cross"}})],1),e._v(" "),t("img",{staticClass:"mx-2",attrs:{src:img.asset_src}})])})),0):e._e(),e._v(" "),e.isEditable?t("div",{staticClass:"flex justify-end w-full"},[t("Btn",{attrs:{"icon-btn":"",icon:e.galleryModel&&e.galleryModel.length?"pencil":"plus"},on:{click:e.openModal}})],1):e._e(),e._v(" "),e.modalId==="pick-gallery-".concat(e.realId)?t("AssetsModal",{attrs:{assets:e.assets,pick:"multiple",picked:Object(r.a)(e.galleryModel),"pick-limit":4,data:e.data},on:{confirm:e.confirmGallery}}):e._e()],1)])}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{Icon:n(472).default,Btn:n(471).default,AssetsModal:n(481).default})},564:function(e,t,n){"use strict";n.r(t);n(18),n(30),n(39),n(40);var r=n(6),l=n(13),o=(n(52),n(11),n(20),n(25),n(51),n(27),n(70),n(470)),c=n(31),d=n(523);function f(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function m(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?f(Object(source),!0).forEach((function(t){Object(l.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):f(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var v={props:{assets:o.a.array.def([]),travels:o.a.array.def([]),articles:o.a.array.def([]),anecdotes:o.a.array.def([]),article:o.a.array.def(null)},data:function(){var e=[{key:"small",label:this.$t("article.size.small")},{key:"normal",label:this.$t("article.size.normal")},{key:"large",label:this.$t("article.size.large")}];return{isNew:!0,isPublished:!1,mounted:!1,countries:[],sizes:e,model:{id:"",published:!1,published_date:"",title:"",cover_desktop:null,cover_mobile:null,travel:null,country:{},size:e[1],place:"",dates:null,slug:"",gallery:[],short_desc:"",long_desc:null}}},computed:m(m({},Object(c.c)("modal",["visible","modalId"])),{},{locale:function(){return this.$i18n.locale}}),mounted:function(){var e=this;if(this.isNew=!this.article||!this.article[0]||!this.article[0].article_id,this.isNew)this.mounted=!0;else try{var t=Object(d.a)("article",{data:this.article[0],locale:this.locale,otherData:{travels:this.travels,assets:this.assets,articles:this.articles}});Object.keys(t).forEach((function(n){e.model[n]="size"===n?{key:t[n],label:e.$t("article.size.".concat(t[n]))}:t[n]})),this.isPublished=this.model.published,this.getCountries(t.travel,!1),this.mounted=!0}catch(e){console.warn(e),this.$router.push("/articles")}},methods:m(m({},Object(c.b)("modal",["setVisible","setModalId"])),{},{getCountries:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t&&this.model.country&&(this.model.country=null);var n=e["travel_countries_".concat(this.locale)];this.countries=n&&n.length?n.map((function(e){return{key:e.toLowerCase().replace(" ","_"),label:e}})):[]},handleGalleryChange:function(e){this.model.gallery=e},handleCoverChange:function(e,t){this.model["cover_".concat(t)]=e},reloadData:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n,data,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.mounted=!1,e.model={},t.prev=2,t.next=5,e.$axios.get("/api/articles/".concat(e.$route.params.id));case 5:n=t.sent,(data=n.data)?(r=Object(d.a)("article",{data:data[0],locale:e.locale,otherData:{travels:e.travels,assets:e.assets,articles:e.articles}}),Object.keys(r).map((function(t){e.$set(e.model,t,r[t])})),e.isPublished=e.model.published,e.mounted=!0):e.$router.push("/articles"),t.next=14;break;case 10:t.prev=10,t.t0=t.catch(2),console.warn(t.t0),e.$router.push("/articles");case 14:case"end":return t.stop()}}),t,null,[[2,10]])})))()},saveArticle:function(e){this.model.long_desc=this.$refs.longDescription.getBlocks(),this.model.gallery=this.$refs.gallery.getContent();var t=Object(d.b)("article",{data:this.model,otherData:{travels:this.travels,articles:this.articles,assets:this.assets},locale:this.locale});t.article_id?("publish"===e&&(t["article_published_".concat(this.locale)]=1,t["article_published_date_".concat(this.locale)]=Date.parse(new Date)),"unpublish"===e&&(t["article_published_".concat(this.locale)]=0,t["article_published_date_".concat(this.locale)]=null),this.updateArticle(t,e)):this.createArticle(t)},createArticle:function(article){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$axios.post("/api/articles",article);case 3:n=t.sent,r=n.data,e.$toast.success(e.$t("article.save.success")),e.$router.push("/articles/".concat(r[0].article_id)),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(0),console.warn(t.t0),e.$toast.error(e.$t("article.save.error"));case 13:case"end":return t.stop()}}),t,null,[[0,9]])})))()},updateArticle:function(article,e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,t.$axios.put("/api/articles/".concat(article.article_id),article);case 3:"publish"===e?t.publishArticle(article):"unpublish"===e?t.unpublishArticle(article.article_id):t.$toast.success(t.$t("article.update.success")),n.next=10;break;case 6:n.prev=6,n.t0=n.catch(0),console.warn(n.t0),t.$toast.error(t.$t("article.update.error"));case 10:return n.prev=10,t.reloadData(),n.finish(10);case 13:case"end":return n.stop()}}),n,null,[[0,6,10,13]])})))()},publishArticle:function(article){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$axios.post("/api/articles/published/".concat(article.article_id),article);case 3:e.$toast.success(e.$t("article.published.success")),t.next=10;break;case 6:t.prev=6,t.t0=t.catch(0),console.warn(t.t0),e.$toast.error(e.$t("article.published.error"));case 10:case"end":return t.stop()}}),t,null,[[0,6]])})))()},unpublishArticle:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,t.$axios.delete("/api/articles/published/".concat(e));case 3:t.$toast.success(t.$t("article.unpublished.success")),n.next=10;break;case 6:n.prev=6,n.t0=n.catch(0),console.warn(n.t0),t.$toast.error(t.$t("article.unpublished.error"));case 10:case"end":return n.stop()}}),n,null,[[0,6]])})))()},removeArticle:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$axios.delete("/api/articles/".concat(e.model.id));case 3:e.$toast.success(e.$t("article.remove.success")),e.closeRemoveModal(),e.$router.push("/articles"),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(0),console.warn(t.t0),e.$toast.error(e.$t("article.remove.error"));case 12:case"end":return t.stop()}}),t,null,[[0,8]])})))()},openRemoveModal:function(){this.setVisible(!0),this.setModalId("remove-article")},closeRemoveModal:function(){this.setVisible(!1),this.setModalId(null)}})},h=v,_=n(36),component=Object(_.a)(h,(function(){var e=this,t=e._self._c;return t("div",[t("EntityActions",{attrs:{"is-new":e.isNew,"is-published":e.isPublished},on:{save:e.saveArticle,publish:function(t){return e.saveArticle("publish")},unpublish:function(t){return e.saveArticle("unpublish")},remove:e.openRemoveModal}},[e.mounted?t("form",[t("InputText",{attrs:{label:e.$t("article.title")},model:{value:e.model.title,callback:function(t){e.$set(e.model,"title",t)},expression:"model.title"}}),e._v(" "),t("ChooseImage",{attrs:{id:"desktop",image:e.model.cover_desktop,assets:e.assets,data:{travels:e.travels,articles:e.articles},label:e.$t("article.cover_desktop")},on:{change:function(t){return e.handleCoverChange(t,"desktop")}}}),e._v(" "),t("ChooseImage",{attrs:{id:"mobile",image:e.model.cover_mobile,assets:e.assets,data:{travels:e.travels,articles:e.articles},label:e.$t("article.cover_mobile")},on:{change:function(t){return e.handleCoverChange(t,"mobile")}}}),e._v(" "),t("Select",{attrs:{label:e.$t("article.travel"),options:e.travels,"option-label":"travel_title_".concat(e.locale)},on:{input:e.getCountries},model:{value:e.model.travel,callback:function(t){e.$set(e.model,"travel",t)},expression:"model.travel"}}),e._v(" "),t("Select",{attrs:{label:e.$t("article.country"),options:e.countries},model:{value:e.model.country,callback:function(t){e.$set(e.model,"country",t)},expression:"model.country"}}),e._v(" "),t("Select",{attrs:{label:e.$t("article.size.title"),sublabel:e.$t("article.size.subtitle"),options:e.sizes},model:{value:e.model.size,callback:function(t){e.$set(e.model,"size",t)},expression:"model.size"}}),e._v(" "),t("InputText",{attrs:{label:e.$t("article.place")},model:{value:e.model.place,callback:function(t){e.$set(e.model,"place",t)},expression:"model.place"}}),e._v(" "),t("Datepicker",{attrs:{label:e.$t("article.dates"),model:e.model.dates},on:{change:function(t){e.model.dates=t}}}),e._v(" "),t("InputText",{attrs:{label:e.$t("article.slug")},model:{value:e.model.slug,callback:function(t){e.$set(e.model,"slug",t)},expression:"model.slug"}}),e._v(" "),t("Textarea",{attrs:{label:e.$t("article.short_desc")},model:{value:e.model.short_desc,callback:function(t){e.$set(e.model,"short_desc",t)},expression:"model.short_desc"}}),e._v(" "),t("GalleryEditor",{ref:"gallery",attrs:{label:e.$t("article.gallery"),assets:e.assets,gallery:e.model.gallery,picked:e.model.gallery,data:{articles:e.articles,travels:e.travels}},on:{"gallery-change":e.handleGalleryChange}}),e._v(" "),t("BlockEditor",{ref:"longDescription",attrs:{label:e.$t("travel.long_desc"),addons:["map-description","anecdote"],blocks:e.model.long_desc,assets:e.assets,data:{travels:e.travels,articles:e.articles,anecdotes:e.anecdotes}}})],1):e._e()]),e._v(" "),"remove-article"===e.modalId?t("RemoveModal",{on:{confirm:e.removeArticle,cancel:e.closeRemoveModal}}):e._e()],1)}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{InputText:n(474).default,ChooseImage:n(518).default,Select:n(477).default,Datepicker:n(519).default,Textarea:n(482).default,GalleryEditor:n(531).default,BlockEditor:n(501).default,EntityActions:n(512).default,RemoveModal:n(484).default})},595:function(e,t,n){"use strict";n.r(t);var r=n(12),l=n(6),o=(n(52),n(11),n(32),n(33),{asyncData:function(e){return Object(l.a)(regeneratorRuntime.mark((function t(){var n,l,o,c,d,f,article,m,v,h,_,y,k,O;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.$axios,l=e.route,o=[],c=[],d=[],f=[],t.prev=5,!l.params.id||"new"===l.params.id){t.next=11;break}return t.next=9,n.get("/api/articles/".concat(l.params.id));case 9:m=t.sent,article=m?m.data:null;case 11:return t.next=13,Promise.all([n.get("/api/assets"),n.get("/api/travels"),n.get("/api/articles"),n.get("/api/anecdotes")]);case 13:v=t.sent,h=Object(r.a)(v,4),_=h[0],y=h[1],k=h[2],O=h[3],o=_.data,c=y.data,d=k.data,f=O.data,t.next=28;break;case 25:t.prev=25,t.t0=t.catch(5),console.log(t.t0);case 28:return console.log(article),t.abrupt("return",{assets:o,travels:c,article:article,articles:d,anecdotes:f});case 30:case"end":return t.stop()}}),t,null,[[5,25]])})))()}}),c=n(36),component=Object(c.a)(o,(function(){var e=this;return(0,e._self._c)("ArticleForm",{attrs:{assets:e.assets,travels:e.travels,article:e.article,articles:e.articles,anecdotes:e.anecdotes}})}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{ArticleForm:n(564).default})}}]);