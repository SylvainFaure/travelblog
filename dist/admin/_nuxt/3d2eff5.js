(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{298:function(e,t,r){var content=r(321);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(62).default)("55317c29",content,!0,{sourceMap:!1})},319:function(e,t,r){"use strict";r.d(t,"a",(function(){return d})),r.d(t,"b",(function(){return v}));r(19),r(27),r(82),r(17),r(36),r(37),r(28),r(40),r(63),r(18);var l=r(9),c=r(52);function n(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}function o(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?n(Object(source),!0).forEach((function(t){Object(l.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):n(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}function d(e,t){var data=t.data,r=t.locale,l=t.otherData,c=void 0===l?{}:l;return _[e].input(data,r,c)}function v(e,t){var data=t.data,r=t.locale,l=t.otherData,c=void 0===l?{}:l;return _[e].output(data,r,c)}var _={travel:{input:function(e,t,r){return{id:e.travel_id,published:!!e["travel_published_".concat(t)],published_date:e["travel_published_date_".concat(t)]||"",same_start_end:!!e.travel_same_start_end,title:e["travel_title_".concat(t)]||"",slug:e["travel_slug_".concat(t)]||"",category:e.travel_category?r.categories.find((function(t){return t.category_id===e.travel_category})):{},cover_desktop:e["travel_cover_".concat(t)]?r.assets.find((function(r){return r.asset_id===e["travel_cover_".concat(t)]})):null,cover_mobile:e["travel_cover_mobile_".concat(t)]?r.assets.find((function(r){return r.asset_id===e["travel_cover_mobile_".concat(t)]})):null,countries:e["travel_countries_".concat(t)],dates:[e.travel_start_date,e.travel_end_date],hashtags:e.travel_hashtags||[],playlist:e["travel_playlist_".concat(t)]||"",short_desc:e["travel_desc_".concat(t)]||"",long_desc:e["travel_long_desc_".concat(t)]||[]}},output:function(e,t,r){var n,d=e.id?r.travels.find((function(t){return e.id===t.travel_id})):null;Object.keys(d).forEach((function(e){"object"===Object(c.a)(d[e])&&(d[e]=JSON.stringify(d[e]))}));var v=d||{};return v=o(o({},v),{},(n={},Object(l.a)(n,"travel_title_".concat(t),e.title),Object(l.a)(n,"travel_category",e.category.category_id),Object(l.a)(n,"travel_cover_".concat(t),e.cover_desktop?e.cover_desktop.asset_id:null),Object(l.a)(n,"travel_cover_mobile_".concat(t),e.cover_mobile?e.cover_mobile.asset_id:null),Object(l.a)(n,"travel_countries_".concat(t),JSON.stringify(e.countries)),Object(l.a)(n,"travel_slug_".concat(t),e.slug),Object(l.a)(n,"travel_desc_".concat(t),e.short_desc),Object(l.a)(n,"travel_playlist_".concat(t),e.playlist),Object(l.a)(n,"travel_long_desc_".concat(t),JSON.stringify(e.long_desc)),Object(l.a)(n,"travel_start_date",e.dates[0]),Object(l.a)(n,"travel_end_date",e.dates[1]),Object(l.a)(n,"travel_hashtags",JSON.stringify(e.hashtags)),n))}},article:{input:function(article,e,t){return{id:article.article_id,published:!!article["article_published_".concat(e)],published_date:article["article_published_date_".concat(e)]||"",title:article["article_title_".concat(e)]||"",slug:article["article_slug_".concat(e)]||"",cover_desktop:article["article_cover_".concat(e)]?t.assets.find((function(t){return t.asset_id===article["article_cover_".concat(e)]})):null,cover_mobile:article["article_cover_mobile_".concat(e)]?t.assets.find((function(t){return t.asset_id===article["article_cover_mobile_".concat(e)]})):null,place:article["article_place_".concat(e)]||"",country:{key:article["article_country_".concat(e)].toLowerCase().replace(" ","_"),label:article["article_country_".concat(e)]},size:article["article_size_".concat(e)],travel:article.article_travel_id?t.travels.find((function(e){return e.travel_id===article.article_travel_id})):null,dates:[article.article_start_date,article.article_end_date],gallery:article["article_gallery_".concat(e)]||[],short_desc:article["article_short_desc_".concat(e)]||"",long_desc:article["article_long_desc_".concat(e)]||[]}},output:function(article,e,t){var r,n=article.id?t.articles.find((function(e){return article.id===e.article_id})):null;Object.keys(n).forEach((function(e){"object"===Object(c.a)(n[e])&&(n[e]=JSON.stringify(n[e]))}));var d=n||{};return d=o(o({},d),{},(r={},Object(l.a)(r,"article_title_".concat(e),article.title),Object(l.a)(r,"article_cover_".concat(e),article.cover_desktop?article.cover_desktop.asset_id:null),Object(l.a)(r,"article_cover_mobile_".concat(e),article.cover_mobile?article.cover_mobile.asset_id:null),Object(l.a)(r,"article_country_".concat(e),article.country.label),Object(l.a)(r,"article_place_".concat(e),article.place),Object(l.a)(r,"article_slug_".concat(e),article.slug),Object(l.a)(r,"article_short_desc_".concat(e),article.short_desc),Object(l.a)(r,"article_long_desc_".concat(e),JSON.stringify(article.long_desc)),Object(l.a)(r,"article_gallery_".concat(e),JSON.stringify(article.gallery)),Object(l.a)(r,"article_size_".concat(e),article.size.key),Object(l.a)(r,"article_start_date",article.dates[0]),Object(l.a)(r,"article_end_date",article.dates[1]),Object(l.a)(r,"article_travel_id",article.travel.travel_id),r))}}}},320:function(e,t,r){"use strict";var l=r(298);r.n(l).a},321:function(e,t,r){(t=r(61)(!1)).push([e.i,".mx-datepicker{width:100%}.mx-input{border-width:1px;border-color:#e2e8f0}",""]),e.exports=t},327:function(e,t,r){"use strict";r.r(t);r(19),r(27),r(17),r(36),r(37),r(28),r(18);var l=r(9),c=r(286),n=r(20);function o(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}function d(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?o(Object(source),!0).forEach((function(t){Object(l.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):o(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var v={props:{id:c.a.string.def(""),label:c.a.string.def("Choose an image"),image:c.a.object.def(null),assets:c.a.array.def([]),data:c.a.object.def(null)},data:function(){return{imageModel:null,realId:Math.floor(1e4*Math.random())}},computed:d({},Object(n.c)("modal",["visible","modalId"])),mounted:function(){this.image&&(this.imageModel=this.image),this.id&&(this.realId=this.id)},methods:d(d({},Object(n.b)("modal",["setVisible","setModalId"])),{},{openModal:function(){this.setVisible(!0),this.setModalId("pick-image-".concat(this.id))},confirmImage:function(image){this.imageModel=image,this.$emit("change",image)}})},_=r(24),component=Object(_.a)(v,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[e.label?r("h4",{staticClass:"label font-bold my-4"},[r("span",{staticClass:"bg-white z-10 pr-6"},[e._v(e._s(e.label))])]):e._e(),e._v(" "),r("div",[e.imageModel?r("div",{staticClass:"justify-self-center"},[r("img",{staticClass:"h-56",attrs:{src:e.imageModel.asset_src}})]):e._e(),e._v(" "),r("div",{staticClass:"flex justify-end w-full"},[r("Btn",{attrs:{"icon-btn":"",icon:e.image?"pencil":"plus"},on:{click:e.openModal}})],1),e._v(" "),e.modalId==="pick-image-"+e.id?r("AssetsModal",{attrs:{assets:e.assets,picked:e.imageModel,data:e.data},on:{confirm:e.confirmImage}}):e._e()],1)])}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{Btn:r(287).default,AssetsModal:r(304).default})},328:function(e,t,r){"use strict";r.r(t);var l=r(286),c=r(323),n=(r(332),r(333),{components:{DatePicker:c.default},props:{label:l.a.string.def(null),model:l.a.array.def(null),placeholder:l.a.string.def(null)},data:function(){return{dateModel:[new Date,new Date]}},watch:{dateModel:function(e,t){e!==t&&this.$emit("change",e)}},mounted:function(){this.model&&(this.dateModel=this.model)}}),o=(r(320),r(24)),component=Object(o.a)(n,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[e.label?r("h4",{staticClass:"label font-bold my-4"},[r("span",{staticClass:"bg-white z-10 pr-6"},[e._v(e._s(e.label))])]):e._e(),e._v(" "),r("date-picker",{attrs:{type:"date",range:"",placeholder:e.placeholder,"value-type":"timestamp"},model:{value:e.dateModel,callback:function(t){e.dateModel=t},expression:"dateModel"}})],1)}),[],!1,null,null,null);t.default=component.exports},362:function(e,t,r){"use strict";r.r(t);r(19),r(27),r(17),r(36),r(37),r(28),r(18),r(32);var l=r(4),c=r(9),n=r(286),o=r(20),d=r(319);function v(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}function _(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?v(Object(source),!0).forEach((function(t){Object(c.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):v(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var f={props:{assets:n.a.array.def([]),travels:n.a.array.def([]),articles:n.a.array.def([]),categories:n.a.array.def([]),anecdotes:n.a.array.def([])},data:function(){return{isNew:!0,isPublished:!1,mounted:!1,model:{id:"",published:!1,published_date:"",title:"",category:{},cover_desktop:null,cover_mobile:null,countries:[],dates:[],hashtags:"",playlist:"",slug:"",short_desc:"",long_desc:""}}},computed:_(_({},Object(o.c)("modal",["visible","modalId"])),{},{locale:function(){return this.$i18n.locale}}),mounted:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){var r,data,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.isNew="new"===e.$route.params.id,e.isNew){t.next=16;break}return t.prev=2,t.next=5,e.$axios.get("/api/travels/".concat(e.$route.params.id));case 5:r=t.sent,(data=r.data)?(l=Object(d.a)("travel",{data:data[0],locale:e.locale,otherData:{travels:e.travels,assets:e.assets,categories:e.categories}}),e.model=l,e.isPublished=e.model.published,e.mounted=!0):e.mounted=!0,t.next=14;break;case 10:t.prev=10,t.t0=t.catch(2),console.warn(t.t0),e.$router.push("/travels");case 14:t.next=17;break;case 16:e.mounted=!0;case 17:case"end":return t.stop()}}),t,null,[[2,10]])})))()},methods:_(_({},Object(o.b)("modal",["setVisible","setModalId"])),{},{reloadData:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){var r,data,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.mounted=!1,t.prev=1,t.next=4,e.$axios.get("/api/travels/".concat(e.$route.params.id));case 4:r=t.sent,(data=r.data)?(l=Object(d.a)("travel",{data:data[0],locale:e.locale,otherData:{travels:e.travels,assets:e.assets,categories:e.categories}}),e.model=l,e.isPublished=e.model.published,e.mounted=!0):e.$router.push("/travels"),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),console.warn(t.t0),e.$router.push("/travels");case 13:case"end":return t.stop()}}),t,null,[[1,9]])})))()},saveTravel:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.model.long_desc=this.$refs.longDescription.getBlocks();var t=Object(d.b)("travel",{data:this.model,otherData:{travels:this.travels,articles:this.articles,assets:this.assets},locale:this.locale});t.travel_id?("publish"===e&&(t["travel_published_".concat(this.locale)]=1,t["travel_published_date_".concat(this.locale)]=Date.parse(new Date)),"unpublish"===e&&(t["travel_published_".concat(this.locale)]=0,t["travel_published_date_".concat(this.locale)]=null),this.updateTravel(t,e)):this.createTravel(t)},createTravel:function(e){var t=this;return Object(l.a)(regeneratorRuntime.mark((function r(){var l,data;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,t.$axios.post("/api/travels",e);case 3:l=r.sent,data=l.data,t.$toast.success(t.$t("travel.save.success")),t.$router.push("/travels/".concat(data[0].travel_id)),r.next=12;break;case 9:r.prev=9,r.t0=r.catch(0),t.$toast.error(t.$t("travel.save.error"));case 12:case"end":return r.stop()}}),r,null,[[0,9]])})))()},updateTravel:function(e,t){var r=this;return Object(l.a)(regeneratorRuntime.mark((function l(){return regeneratorRuntime.wrap((function(l){for(;;)switch(l.prev=l.next){case 0:return l.prev=0,l.next=3,r.$axios.put("/api/travels/".concat(e.travel_id),e);case 3:"publish"===t?r.publishTravel(e):"unpublish"===t?r.unpublishTravel(e.travel_id):r.$toast.success(r.$t("travel.update.success")),l.next=10;break;case 6:l.prev=6,l.t0=l.catch(0),console.log(l.t0),r.$toast.error(r.$t("travel.update.error"));case 10:return l.prev=10,r.reloadData(),l.finish(10);case 13:case"end":return l.stop()}}),l,null,[[0,6,10,13]])})))()},publishTravel:function(e){var t=this;return Object(l.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,t.$axios.post("/api/travels/published/".concat(e.travel_id),e);case 3:t.$toast.success(t.$t("travel.published.success")),r.next=10;break;case 6:r.prev=6,r.t0=r.catch(0),console.warn(r.t0),t.$toast.error(t.$t("travel.published.error"));case 10:case"end":return r.stop()}}),r,null,[[0,6]])})))()},unpublishTravel:function(e){var t=this;return Object(l.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,t.$axios.delete("/api/travels/published/".concat(e));case 3:t.$toast.success(t.$t("travel.unpublished.success")),r.next=10;break;case 6:r.prev=6,r.t0=r.catch(0),console.warn(r.t0),t.$toast.error(t.$t("travel.unpublished.error"));case 10:case"end":return r.stop()}}),r,null,[[0,6]])})))()},removeTravel:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$axios.delete("/api/travels/".concat(e.model.id));case 3:e.$toast.success(e.$t("travel.remove.success")),e.closeRemoveModal(),e.$router.push("/travels"),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(0),console.warn(t.t0),e.$toast.error(e.$t("travel.remove.error"));case 12:case"end":return t.stop()}}),t,null,[[0,8]])})))()},openRemoveModal:function(){this.setVisible(!0),this.setModalId("remove-travel")},closeRemoveModal:function(){this.setVisible(!1),this.setModalId(null)}})},h=r(24),component=Object(h.a)(f,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("EntityActions",{attrs:{"is-new":e.isNew,"is-published":e.isPublished},on:{save:e.saveTravel,publish:function(t){return e.saveTravel("publish")},unpublish:function(t){return e.saveTravel("unpublish")},remove:e.openRemoveModal}},[e.mounted?r("form",[r("InputText",{attrs:{label:e.$t("travel.title")},model:{value:e.model.title,callback:function(t){e.$set(e.model,"title",t)},expression:"model.title"}}),e._v(" "),e.categories?r("Select",{attrs:{label:e.$t("travel.category"),options:e.categories,"option-label":"category_label_"+e.locale},model:{value:e.model.category,callback:function(t){e.$set(e.model,"category",t)},expression:"model.category"}}):e._e(),e._v(" "),r("ChooseImage",{attrs:{id:"desktop",image:e.model.cover_desktop,assets:e.assets,label:e.$t("travel.cover_desktop"),data:{travels:e.travels,articles:e.articles}},on:{change:function(t){e.model.cover_desktop=t}}}),e._v(" "),r("ChooseImage",{attrs:{id:"mobile",image:e.model.cover_mobile,assets:e.assets,label:e.$t("travel.cover_mobile"),data:{travels:e.travels,articles:e.articles}},on:{change:function(t){e.model.cover_mobile=t}}}),e._v(" "),r("InputTags",{attrs:{label:e.$t("travel.countries"),value:e.model.countries},on:{change:function(t){e.model.countries=t}}}),e._v(" "),r("Datepicker",{attrs:{label:e.$t("travel.dates"),model:e.model.dates},on:{change:function(t){e.model.dates=t}}}),e._v(" "),r("InputTags",{attrs:{label:e.$t("travel.hashtags"),value:e.model.hashtags},on:{change:function(t){e.model.hashtags=t}}}),e._v(" "),r("InputText",{attrs:{label:e.$t("travel.playlist")},model:{value:e.model.playlist,callback:function(t){e.$set(e.model,"playlist",t)},expression:"model.playlist"}}),e._v(" "),r("InputText",{attrs:{label:e.$t("travel.slug")},model:{value:e.model.slug,callback:function(t){e.$set(e.model,"slug",t)},expression:"model.slug"}}),e._v(" "),r("Textarea",{attrs:{label:e.$t("travel.short_desc")},model:{value:e.model.short_desc,callback:function(t){e.$set(e.model,"short_desc",t)},expression:"model.short_desc"}}),e._v(" "),r("BlockEditor",{ref:"longDescription",attrs:{label:e.$t("travel.long_desc"),addons:["map-description","anecdote"],blocks:e.model.long_desc,assets:e.assets,data:{travels:e.travels,articles:e.articles,anecdotes:e.anecdotes}}})],1):e._e()]),e._v(" "),"remove-travel"===e.modalId?r("RemoveModal",{on:{confirm:e.removeTravel,cancel:e.closeRemoveModal}}):e._e()],1)}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{InputText:r(291).default,Select:r(294).default,ChooseImage:r(327).default,InputTags:r(366).default,Datepicker:r(328).default,Textarea:r(299).default,BlockEditor:r(301).default,EntityActions:r(302).default,RemoveModal:r(293).default})},366:function(e,t,r){"use strict";r.r(t);r(27);var l=r(286),c={props:{value:l.a.array.def([]),label:l.a.string.def(null),options:l.a.array.def([])},data:function(){return{inputModel:"",tags:[]}},mounted:function(){this.value&&(this.tags=this.value)},methods:{addTag:function(){this.tags.push(this.inputModel),this.inputModel="",this.$emit("change",this.tags)},removeTag:function(e){this.tags=this.tags.filter((function(t){return t!==e})),this.$emit("change",this.tags)}}},n=r(24),component=Object(n.a)(c,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[e.label?r("h4",{staticClass:"label font-bold my-4"},[r("span",{staticClass:"bg-white z-10 pr-6"},[e._v(e._s(e.label))])]):e._e(),e._v(" "),r("div",{staticClass:"flex flex-wrap"},e._l(e.tags,(function(t){return r("Tag",{key:t,staticClass:"mr-2 my-2",attrs:{tag:t,deletable:""},on:{remove:e.removeTag}})})),1),e._v(" "),r("div",{staticClass:"relative"},[r("InputText",{on:{enter:e.addTag},model:{value:e.inputModel,callback:function(t){e.inputModel=t},expression:"inputModel"}}),e._v(" "),r("div",{staticClass:"cursor-pointer text-white absolute right-0 top-0 h-full w-12 bg-gray-600 flex justify-center items-center",on:{click:e.addTag}},[r("Icon",{attrs:{name:"plus"}})],1)],1)])}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{Tag:r(303).default,InputText:r(291).default,Icon:r(289).default})},378:function(e,t,r){"use strict";r.r(t);r(16),r(38),r(39);var l=r(15),c=(r(32),r(4)),n={asyncData:function(e){return Object(c.a)(regeneratorRuntime.mark((function t(){var r,c,n,o,d,v,_,f,h,m,O,y,j;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.$axios,c=[],n=[],o=[],d=[],v=[],t.prev=6,t.next=9,Promise.all([r.get("/api/assets"),r.get("/api/travels"),r.get("/api/articles"),r.get("/api/categories"),r.get("/api/anecdotes")]);case 9:_=t.sent,f=Object(l.a)(_,5),h=f[0],m=f[1],O=f[2],y=f[3],j=f[4],c=h.data,n=m.data,o=y.data,d=O.data,v=j.data,t.next=26;break;case 23:t.prev=23,t.t0=t.catch(6),console.log(t.t0);case 26:return t.abrupt("return",{assets:c,travels:n,articles:d,categories:o,anecdotes:v});case 27:case"end":return t.stop()}}),t,null,[[6,23]])})))()}},o=r(24),component=Object(o.a)(n,(function(){var e=this.$createElement;return(this._self._c||e)("TravelForm",{attrs:{assets:this.assets,travels:this.travels,articles:this.articles,categories:this.categories,anecdotes:this.anecdotes}})}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{TravelForm:r(362).default})}}]);